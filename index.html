<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Risikoanalyse für mittelständische Unternehmen</title>

    <script src="https://cdn.tailwindcss.com"></script>

    <script src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>

    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        .prose { max-width: 65ch; color: #374151; }
        .prose h3 { font-size: 1.25rem; font-weight: 600; margin-bottom: 1rem; }
        .prose p, .prose ul, .prose ol { margin-bottom: 1rem; }
        .prose strong, .prose b { font-weight: 600; }
        .slide-in-right { animation: slideInRight 0.3s ease-out forwards; }
        @keyframes slideInRight {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        .animate-pulse-fast {
            animation: pulse 1.5s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            50% {
                opacity: .5;
            }
        }
    </style>
</head>

<body class="bg-gray-50">
    <div id="root"></div>
    
    <script type="text/babel">
        // --- DEPENDENCIES & SETUP ---
        const { useState, useEffect, useMemo, useRef } = React;
        
        // ---LUCIDE ICONS (self-contained SVGs) ---
        const createIcon = (svg) => (props) => (
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>{svg}</svg>
        );

        const lucide = {
            ChevronUp: createIcon(<><path d="m18 15-6-6-6 6"/></>),
            ChevronDown: createIcon(<><path d="m6 9 6 6 6-6"/></>),
            ArrowLeft: createIcon(<><path d="m12 19-7-7 7-7"/><path d="M19 12H5"/></>),
            DollarSign: createIcon(<><line x1="12" x2="12" y1="2" y2="22" /><path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6" /></>),
            Linkedin: createIcon(<><path d="M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z" /><rect width="4" height="12" x="2" y="9" /><circle cx="4" cy="4" r="2" /></>),
            Mail: createIcon(<><rect width="20" height="16" x="2" y="4" rx="2" /><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7" /></>),
            Phone: createIcon(<><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z" /></>),
            Radar: createIcon(<><path d="M19.07 4.93A10 10 0 0 0 6.99 3.34"/><path d="M4.93 19.07A10 10 0 0 0 16.43 21.8"/><path d="M3.34 6.99A10 10 0 0 0 4.93 19.07"/><path d="M21.8 16.43A10 10 0 0 0 19.07 4.93"/><path d="M2 12h2"/><path d="M20 12h2"/><path d="m6.34 17.66 1.42-1.42"/><path d="m16.24 7.76 1.42-1.42"/><path d="m12 2 1.41 1.41"/><path d="M12 20v2"/><path d="m17.66 17.66 1.42 1.42"/><path d="m4.93 4.93 1.42 1.42"/></>),
            BarChart3: createIcon(<><path d="M3 3v18h18" /><path d="M7 16V7" /><path d="M12 16v-4" /><path d="M17 16v-7" /></>),
            Briefcase: createIcon(<><rect width="20" height="14" x="2" y="7" rx="2" ry="2" /><path d="M16 21V5a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16" /></>),
            Building2: createIcon(<><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18" /><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2" /><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2" /><path d="M10 6h4" /><path d="M10 10h4" /><path d="M10 14h4" /><path d="M10 18h4" /></>),
            Cpu: createIcon(<><rect width="16" height="16" x="4" y="4" rx="2" /><rect width="6" height="6" x="9" y="9" rx="1" /><path d="M15 2v2" /><path d="M15 20v2" /><path d="M2 15h2" /><path d="M2 9h2" /><path d="M20 15h2" /><path d="M20 9h2" /><path d="M9 2v2" /><path d="M9 20v2" /></>),
            Download: createIcon(<><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" /><polyline points="7 10 12 15 17 10" /><line x1="12" x2="12" y1="15" y2="3" /></>),
            Upload: createIcon(<><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4" /><polyline points="17 8 12 3 7 8" /><line x1="12" x2="12" y1="3" y2="15" /></>),
            Users: createIcon(<><path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2" /><circle cx="9" cy="7" r="4" /><path d="M22 21v-2a4 4 0 0 0-3-3.87" /><path d="M16 3.13a4 4 0 0 1 0 7.75" /></>),
            ArrowRight: createIcon(<><path d="M5 12h14" /><path d="m12 5 7 7-7 7" /></>),
            CheckCircle: createIcon(<><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14" /><path d="m9 11 3 3L22 4" /></>),
            RotateCcw: createIcon(<><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8" /><path d="M3 3v5h5" /></>),
            ShieldCheck: createIcon(<><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" /><path d="m9 12 2 2 4-4" /></>),
            Sparkles: createIcon(<><path d="m12 3-1.9 1.9-1.1-3-1.1 3L6 6l3 1.1-3 1.1 1.9 1.9 1.1 3 1.1-3 1.9-1.9-3-1.1Z" /><path d="M18 13.5-16.5 12l-1.5 1.5 1.5 1.5 1.5-1.5 1.5 1.5-1.5 1.5 1.5 1.5Z" /></>),
            FileText: createIcon(<><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z" /><polyline points="14 2 14 8 20 8" /><line x1="16" x2="8" y1="13" y2="13" /><line x1="16" x2="8" y1="17" y2="17" /><line x1="10" x2="8" y1="9" y2="9" /></>),
            X: createIcon(<><path d="M18 6 6 18" /><path d="m6 6 12 12" /></>),
            TrendingDown: createIcon(<><polyline points="22 17 13.5 8.5 8.5 13.5 2 7" /><polyline points="16 17 22 17 22 11" /></>),
            TrendingUp: createIcon(<><polyline points="22 7 13.5 15.5 8.5 10.5 2 17"/><polyline points="16 7 22 7 22 13"/></>),
            Landmark: createIcon(<><line x1="2" x2="22" y1="22" y2="22" /><line x1="6" x2="6" y1="18" y2="11" /><line x1="10" x2="10" y1="18" y2="11" /><line x1="14" x2="14" y1="18" y2="11" /><line x1="18" x2="18" y1="18" y2="11" /><polygon points="4 22 4 11 12 3 20 11 20 22" /></>),
            Info: createIcon(<><circle cx="12" cy="12" r="10" /><line x1="12" x2="12" y1="16" y2="12" /><line x1="12" x2="12.01" y1="8" y2="8" /></>),
            Lock: createIcon(<><rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect><path d="M7 11V7a5 5 0 0 1 10 0v4"></path></>),
        };

        const { Radar, BarChart3, Briefcase, Building2, Cpu, Download, Upload, Users, ArrowRight, ArrowLeft, CheckCircle, RotateCcw, ShieldCheck, Sparkles, FileText, X, TrendingDown, TrendingUp, Landmark, Info, Linkedin, Mail, Phone, DollarSign, ChevronUp, ChevronDown, Lock } = lucide;

        // --- GEMINI API-AUFRUF ---
        async function callGeminiAPI(prompt, isJson = false) {
            // In a real application, the API key should be handled securely on the server-side.
            // For this prototype, it's included here but should not be done in production.
            const apiKey = "AIzaSyBUE7bGnlayeXWg2_ONFVoT_SHnqptl2fE"; // API Key is handled by the environment
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent?key=${apiKey}`;
            
            const payload = {
                contents: [{ parts: [{ text: prompt }] }],
            };

            if (isJson) {
                payload.generationConfig = {
                    responseMimeType: "application/json",
                };
            }

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    const errorBody = await response.json();
                    console.error("Gemini API Error:", errorBody);
                    throw new Error(`Fehler bei der API-Anfrage: ${response.statusText}`);
                }

                const data = await response.json();
                if (data.candidates && data.candidates.length > 0 && data.candidates[0].content.parts.length > 0) {
                     let textResponse = data.candidates[0].content.parts[0].text;
                     if (isJson) {
                         // Clean the response to extract only the JSON part from potential markdown.
                         const jsonMatch = textResponse.match(/```(?:json)?([\s\S]*?)```/);
                         if (jsonMatch && jsonMatch[1]) {
                             textResponse = jsonMatch[1];
                         }
                         
                         try {
                            // Additional cleaning for artifacts like 'pulsedata'
                            const cleanedText = textResponse.replace(/pulsedata/g, '').trim();
                            return JSON.parse(cleanedText);
                         } catch(e) {
                            console.error("JSON Parsing Error:", e);
                            console.error("Problematic response from API:", textResponse);
                            throw new Error("Fehler beim Verarbeiten der JSON-Antwort.");
                         }
                     }
                     return textResponse;
                } else {
                    console.error("Unexpected API response structure:", data);
                    throw new Error("Leider konnte keine gültige Antwort erstellt werden.");
                }
            } catch (error) {
                console.error("Fehler im callGeminiAPI: ", error);
                throw error;
            }
        }


        // --- DATA & HELPER FUNCTIONS ---
        const riskMatrix = {
            'Organisation': { label: 'Organisation & Abläufe', weighting: 0.25, riskBands: { 1: 0.05, 2: 0.20, 3: 0.40, 4: 0.60, 5: 0.80 } },
            'Personal': { label: 'Personal & Qualifikation', weighting: 0.20, riskBands: { 1: 0.05, 2: 0.20, 3: 0.45, 4: 0.65, 5: 0.85 } },
            'Markt': { label: 'Markt & Kunden', weighting: 0.20, riskBands: { 1: 0.05, 2: 0.10, 3: 0.20, 4: 0.30, 5: 0.40 } },
            'Finanzen': { label: 'Finanzstabilität & WC-Mgmt.', weighting: 0.15, riskBands: { 1: 0.05, 2: 0.15, 3: 0.30, 4: 0.50, 5: 0.75 } },
            'IT': { label: 'Digitalisierung & IT-Sicherheit', weighting: 0.10, riskBands: { 1: 0.05, 2: 0.10, 3: 0.20, 4: 0.40, 5: 0.60 } },
            'Recht': { label: 'Recht & Compliance', weighting: 0.10, riskBands: { 1: 0.0, 2: 0.10, 3: 0.25, 4: 0.45, 5: 0.70 } }
        };
        const staticBenchmarkKPIs = {
            software: { fluktuation: { label: "Mitarbeiterfluktuation", value: "12%", source: "Bitkom" }, kundenChurn: { label: "Kunden-Churn", value: "7%", source: "Diverse Studien" }, dso: { label: "Forderungslaufzeit (DSO)", value: "45 Tage", source: "Branchenanalysen" }, bruttomarge: { label: "Bruttomarge", value: "75%", source: "SaaS-Studien" } },
            maschinenbau: { fluktuation: { label: "Mitarbeiterfluktuation", value: "6%", source: "VDMA" }, krankenstand: { label: "Krankenstand", value: "5.5%", source: "Branchenreport" }, ekQuote: { label: "Eigenkapitalquote", value: "35%", source: "Ifo-Institut" }, dio: { label: "Lagerdauer (DIO)", value: "80 Tage", source: "Branchenanalysen" } }
        };
        const staticBenchmarkCategories = {
            software: { Organisation: 0.30, Personal: 0.45, Markt: 0.35, Finanzen: 0.20, IT: 0.25, Recht: 0.20 },
            maschinenbau: { Organisation: 0.35, Personal: 0.30, Markt: 0.25, Finanzen: 0.40, IT: 0.40, Recht: 0.30 }
        };
       const ebitdaMultiples = {
            software: {
                name: 'Software & IT-Dienstleistungen',
                subCategories: {
                    'saas': { name: 'SaaS (B2B)', min: 8.0, max: 15.0 },
                    'erp': { name: 'ERP-Software', min: 7.0, max: 10.0 },
                    'cybersecurity': { name: 'Cybersecurity-Software', min: 10.0, max: 18.0 },
                    'fintech': { name: 'FinTech / InsurTech', min: 9.0, max: 16.0 },
                    'healthtech': { name: 'HealthTech', min: 8.5, max: 14.0 },
                    'e-commerce-software': { name: 'E-Commerce Software', min: 6.0, max: 11.0 },
                    'it-services': { name: 'IT-Dienstleistungen (Systemhaus)', min: 5.0, max: 8.0 },
                    'individual': { name: 'Individualsoftware / IT-Projekte', min: 6.0, max: 8.5 }
                },
                sizeAdjustments: {
                    revenue: { '<1m': -0.15, '1-5m': -0.05, '5-10m': 0, '10-50m': 0.05, '>50m': 0.10 },
                    employees: { '<10': -0.10, '10-50': 0, '51-250': 0.05, '>250': 0.10 }
                }
            },
            maschinenbau: {
                name: 'Maschinen- & Anlagenbau',
                subCategories: {
                    'sondermaschinen': { name: 'Sondermaschinenbau', min: 6.0, max: 8.0 },
                    'robotik': { name: 'Robotik & Automation', min: 7.0, max: 11.0 },
                    'werkzeugmaschinen': { name: 'Werkzeugmaschinenbau', min: 5.0, max: 7.5 },
                    'landmaschinen': { name: 'Landmaschinenbau', min: 6.0, max: 8.5 },
                    'anlagenbau': { name: 'Anlagenbau (Großprojekte)', min: 4.5, max: 6.5 },
                    'komponenten': { name: 'Komponenten & Zulieferer', min: 5.5, max: 7.5 },
                },
                sizeAdjustments: {
                    revenue: { '<1m': -0.10, '1-5m': -0.05, '5-10m': 0, '10-50m': 0.05, '>50m': 0.10 },
                    employees: { '<10': -0.10, '10-50': 0, '51-250': 0.05, '>250': 0.10 }
                }
            }
        };

        const getAdjustedMultiples = (industry, subCategory, revenue, employeeCount) => {
            const industryData = ebitdaMultiples[industry];
            const baseMultiples = industryData.subCategories[subCategory];
            const adjustments = industryData.sizeAdjustments;

            let revenueAdjustment = 0;
            if (adjustments.revenue[revenue]) {
                revenueAdjustment = adjustments.revenue[revenue];
            }

            let employeeAdjustment = 0;
            const empCount = parseInt(employeeCount);
            if (empCount < 10) employeeAdjustment = adjustments.employees['<10'];
            else if (empCount >= 10 && empCount <= 50) employeeAdjustment = adjustments.employees['10-50'];
            else if (empCount > 50 && empCount <= 250) employeeAdjustment = adjustments.employees['51-250'];
            else if (empCount > 250) employeeAdjustment = adjustments.employees['>250'];

            const totalAdjustment = 1 + revenueAdjustment + employeeAdjustment;

            return {
                min: baseMultiples.min * totalAdjustment,
                max: baseMultiples.max * totalAdjustment,
            };
        };

        const questionsByIndustry = {
            'software': {
                name: 'Software & IT-Dienstleistungen',
                questions: [
                    // Organisation (4 -> 5)
                    { id: 'org_1', category: 'Organisation', text: 'Wie ist der Dokumentationsgrad Ihrer Kernprozesse (Entwicklung, Vertrieb, Support)?', options: [{ text: 'Vollständig, aktuell und für alle zugänglich (z.B. in Confluence)', value: 1 }, { text: 'Teilweise vorhanden, aber nicht durchgängig gepflegt', value: 3 }, { text: 'Wissen steckt hauptsächlich in den Köpfen der Mitarbeiter', value: 5 }], help: { title: 'Prozessdokumentation', explanation: 'Eine gute Dokumentation reduziert die Abhängigkeit von einzelnen Mitarbeitern, erleichtert die Einarbeitung und ist die Basis für Skalierung und Qualitätsmanagement. Sie ist entscheidend für die Übertragbarkeit (Fungibilität) des Unternehmens.', benchmarkGood: 'Umfassendes Wiki, Prozessdiagramme (BPMN), klare Verantwortlichkeiten.', benchmarkBad: 'Keine schriftlichen Anleitungen, Einarbeitung nur durch Zuruf.' } },
                    { id: 'org_2', category: 'Organisation', text: 'Existiert eine klare, kommunizierte Unternehmensstrategie für die nächsten 3-5 Jahre?', options: [{ text: 'Ja, detailliert, von allen verstanden und mit messbaren Zielen (OKRs) hinterlegt', value: 1 }, { text: 'Ja, aber nur auf Management-Ebene bekannt', value: 3 }, { text: 'Nein, es wird eher reaktiv und operativ agiert', value: 5 }], help: { title: 'Unternehmensstrategie', explanation: 'Eine klare Strategie gibt Orientierung, motiviert das Team und ermöglicht gezielte Investitionen. Ohne sie drohen operative Hektik und verpasste Marktchancen. Ein Käufer will wissen, wohin die Reise geht.', benchmarkGood: 'Jährlicher Strategieprozess, quartalsweise Überprüfung der Ziele.', benchmarkBad: 'Entscheidungen werden rein aus dem Bauch heraus getroffen.' } },
                    { id: 'org_3', category: 'Organisation', text: 'Wie skalierbar sind Ihre internen Abläufe?', options: [{ text: 'Hochgradig automatisiert, können 2x Wachstum ohne Personalaufbau bewältigen', value: 1 }, { text: 'Teilautomatisiert, Wachstum erfordert proportionalen Personalaufbau', value: 3 }, { text: 'Stark manuell, Prozesse sind bereits jetzt am Limit', value: 5 }], help: { title: 'Skalierbarkeit der Abläufe', explanation: 'Skalierbare Prozesse sind ein wesentlicher Werttreiber. Wenn das Unternehmen wachsen kann, ohne dass die Kosten (insb. Personal) im gleichen Maße steigen, ist das für Investoren hochattraktiv.', benchmarkGood: 'Automatisierte Kunden-Onboardings, Self-Service-Portale.', benchmarkBad: 'Jeder neue Kunde erfordert manuelle Einrichtungsschritte durch mehrere Mitarbeiter.' } },
                    { id: 'org_4', category: 'Organisation', text: 'Wie sind Management-Meetings strukturiert und werden Entscheidungen nachvollziehbar dokumentiert?', options: [{ text: 'Strukturierte Meetings mit Agenda und verbindlichen, dokumentierten Beschlüssen', value: 1 }, { text: 'Regelmäßige Meetings, aber oft ohne klare Ergebnisse', value: 3 }, { text: 'Entscheidungen fallen informell, keine Dokumentation', value: 5 }], help: { title: 'Entscheidungsfindung', explanation: 'Transparente und dokumentierte Entscheidungsprozesse sind ein Zeichen guter Unternehmensführung. Sie verhindern Missverständnisse und sorgen für Nachvollziehbarkeit.', benchmarkGood: 'Protokolle mit klaren To-dos und Verantwortlichkeiten (z.B. mit Asana, Jira).', benchmarkBad: 'Wichtige Entscheidungen werden auf dem Flur getroffen.' } },
                    { id: 'org_5', category: 'Organisation', text: 'Gibt es eine zweite Managementebene, die das Tagesgeschäft eigenständig führen kann?', options: [{ text: 'Ja, es gibt eine kompetente, etablierte zweite Führungsebene.', value: 1 }, { text: 'Ansätze sind vorhanden, aber die Abhängigkeit vom Inhaber ist noch hoch.', value: 3 }, { text: 'Nein, alle wesentlichen Entscheidungen trifft der Inhaber.', value: 5 }], help: { title: 'Zweite Managementebene', explanation: 'Eine funktionierende zweite Führungsebene ist entscheidend für die Skalierbarkeit und reduziert das "Key-Man-Risk" des Gründers. Für einen Käufer ist sie oft eine Voraussetzung, um eine reibungslose Übergabe zu gewährleisten.' } },
                    
                    // Personal (7 -> 7) - Unverändert
                    { id: 'pers_1', category: 'Personal', text: 'Wie hoch ist die jährliche, freiwillige Mitarbeiterfluktuation?', benchmarkKey: 'fluktuation', options: [{ text: '< 5% pro Jahr', value: 1 }, { text: '5% - 15% pro Jahr', value: 3 }, { text: '> 15% pro Jahr', value: 5 }], help: { title: 'Mitarbeiterfluktuation', explanation: 'Eine hohe Fluktuation deutet auf Probleme in der Unternehmenskultur, Führung oder Vergütung hin. Sie verursacht hohe Kosten für Recruiting und Einarbeitung und führt zum Verlust von wertvollem Wissen.', calculation: '(Anzahl Kündigungen durch Mitarbeiter / Durchschnittliche Mitarbeiterzahl) * 100', benchmarkGood: 'Unter 5-7% in der IT-Branche.', benchmarkBad: 'Über 15%, ständiger Wechsel in Schlüsselpositionen.' } },
                    { id: 'pers_2', category: 'Personal', text: 'Wie hoch ist die Abhängigkeit von Schlüsselpersonal (Key-Man-Risk)?', options: [{ text: 'Wissen ist breit verteilt und dokumentiert (Pair-Programming, Know-how-Datenbank)', value: 1 }, { text: 'Einzelne Experten sind wichtig, aber Wissenstransfer findet statt', value: 3 }, { text: 'Das Geschäft steht und fällt mit 1-2 Personen', value: 5 }], help: { title: 'Key-Man-Risk', explanation: 'Ein hohes Key-Man-Risk ist eine der größten Gefahren für kleine und mittlere Unternehmen. Der Ausfall (Krankheit, Kündigung) einer Schlüsselperson kann den Betrieb lahmlegen. Ein Käufer bewertet dieses Risiko mit hohen Abschlägen.', benchmarkGood: 'Für jede Schlüsselperson gibt es mindestens einen Stellvertreter.', benchmarkBad: 'Nur der Gründer kennt die Architektur oder den wichtigsten Kunden.' } },
                    { id: 'pers_3', category: 'Personal', text: 'Wie ist die Altersstruktur Ihres Entwickler-Teams?', options: [{ text: 'Gut gemischt, Wissenstransfer zwischen erfahrenen und jungen Entwicklern', value: 1 }, { text: 'Homogen, aber ohne akutes Risiko (z.B. alle zwischen 30-45)', value: 3 }, { text: 'Stark überaltert (>55 Jahre) oder extrem jung und unerfahren (<25 Jahre)', value: 5 }], help: { title: 'Altersstruktur', explanation: 'Eine unausgewogene Altersstruktur birgt Risiken. Eine überalterte Belegschaft führt zu einer Ruhestandswelle und dem Verlust von Erfahrung. Ein sehr junges Team hat möglicherweise Defizite in der Stabilität und strategischen Weitsicht.', benchmarkGood: 'Gesunde Mischung aller Altersgruppen.', benchmarkBad: 'Alle Leistungsträger gehen in den nächsten 5 Jahren in Rente.' } },
                    { id: 'pers_4', category: 'Personal', text: 'Gibt es ein systematisches Weiterbildungsprogramm und -budget?', options: [{ text: 'Ja, mit einem festen Budget pro Mitarbeiter und definierten Entwicklungspfaden', value: 1 }, { text: 'Weiterbildung erfolgt sporadisch und auf Anfrage', value: 3 }, { text: 'Es gibt kein Budget oder Programm für Weiterbildung', value: 5 }], help: { title: 'Weiterbildung', explanation: 'Besonders in der IT ist lebenslanges Lernen entscheidend. Ein systematisches Weiterbildungsprogramm sichert die Qualifikation des Teams, erhöht die Mitarbeiterbindung und sorgt für technologische Aktualität. Fehlende Weiterbildung führt zu veraltetem Know-how.', benchmarkGood: 'Mind. 1.500 € Budget pro Mitarbeiter/Jahr, 5-10 Schulungstage.', benchmarkBad: 'Mitarbeiter müssen für Schulungen privat bezahlen.' } },
                    { id: 'pers_5', category: 'Personal', text: 'Wie ist die Vergütung Ihrer Mitarbeiter im Vergleich zum Markt?', options: [{ text: 'Überdurchschnittlich, wir sind als attraktiver Arbeitgeber bekannt', value: 1 }, { text: 'Marktüblich, wir orientieren uns an Branchenvergleichen', value: 2 }, { text: 'Eher unterdurchschnittlich, was zu Rekrutierungsproblemen führt', value: 4 }], help: { title: 'Vergütungsstruktur', explanation: 'Eine nicht marktgerechte Bezahlung führt zwangsläufig zu hoher Fluktuation und Schwierigkeiten bei der Gewinnung von Talenten. Dies ist ein erhebliches operatives Risiko.', benchmarkGood: 'Regelmäßige Gehalts-Benchmarks, transparente Gehaltsbänder.', benchmarkBad: 'Keine Anpassung der Gehälter über Jahre.' } },
                    { id: 'pers_6', category: 'Personal', text: 'Wie würden Sie die Stimmung und Kultur im Unternehmen beschreiben?', options: [{ text: 'Sehr positiv und leistungsorientiert, hohe Identifikation', value: 1 }, { text: 'Neutral, "Dienst nach Vorschrift"', value: 3 }, { text: 'Negativ, hohe Unzufriedenheit und interne Konflikte', value: 5 }], help: { title: 'Unternehmenskultur', explanation: 'Eine schlechte Unternehmenskultur ist ein "stiller Killer". Sie demotiviert Mitarbeiter, senkt die Produktivität und treibt die Fluktuation in die Höhe.', benchmarkGood: 'Hohe Werte bei Mitarbeiterzufriedenheitsumfragen, geringer Krankenstand.', benchmarkBad: 'Häufige Beschwerden, "Flurfunk" ist die Hauptinformationsquelle.' } },
                    { id: 'pers_7', category: 'Personal', text: 'Gibt es einen formalisierten Onboarding-Prozess für neue Mitarbeiter?', options: [{ text: 'Ja, ein strukturierter Prozess für die ersten 90 Tage ist etabliert', value: 1 }, { text: 'Es gibt eine Einarbeitung, aber sie ist nicht standardisiert', value: 3 }, { text: 'Neue Mitarbeiter werden "ins kalte Wasser geworfen"', value: 4 }], help: { title: 'Onboarding', explanation: 'Ein professionelles Onboarding verkürzt die Einarbeitungszeit, steigert die Mitarbeiterbindung und sorgt dafür, dass neue Teammitglieder schneller produktiv werden.', benchmarkGood: 'Fester Einarbeitungsplan, zugeteilter "Buddy" oder Mentor.', benchmarkBad: 'Am ersten Tag ist weder der Laptop noch ein Zugang eingerichtet.' } },
                    
                    // Markt (6 -> 11)
                    { id: 'markt_1', category: 'Markt', text: 'In welcher Phase des Produktlebenszyklus befindet sich Ihr Kernprodukt?', options: [{ text: 'Wachstum (steigende Nutzerzahlen und Umsätze)', value: 1 }, { text: 'Reife (stabile, hohe Marktanteile)', value: 2 }, { text: 'Sättigung/Rückgang (stagnierend oder fallend)', value: 5 }], help: { title: 'Produktlebenszyklus', explanation: 'Die Position im Lebenszyklus bestimmt die zukünftigen Wachstumsaussichten und notwendigen Investitionen. Ein Produkt in der Wachstumsphase ist für Investoren attraktiver als eines in der Rückgangsphase.', benchmarkGood: 'Klares Portfolio mit Produkten in verschiedenen Lebensphasen.', benchmarkBad: 'Alle Produkte sind "Cash Cows" ohne erkennbares zukünftiges Wachstum.' } },
                    { id: 'markt_2', category: 'Markt', text: 'Wie hoch ist die Abhängigkeit von Plattformen Dritter (z.B. App Stores, Cloud-Provider)?', options: [{ text: 'Gering, wir sind plattformunabhängig oder haben Multi-Cloud-Strategien.', value: 1 }, { text: 'Moderat, ein Wechsel wäre aufwendig, aber möglich.', value: 3 }, { text: 'Hoch, eine Änderung der AGB oder ein Delisting durch die Plattform wäre existenzbedrohend.', value: 5 }], help: { title: 'Plattformabhängigkeit', explanation: 'Eine hohe Abhängigkeit von Anbietern wie Apple, Google oder AWS birgt strategische Risiken. Änderungen an deren Geschäftsbedingungen, Gebührenmodellen oder Algorithmen können Ihr Geschäft direkt negativ beeinflussen.', benchmarkGood: 'Vertraglich abgesicherte, langfristige Partnerschaften.', benchmarkBad: 'Das gesamte Geschäft basiert auf einer einzigen Plattform ohne Alternativen.' } },
                    { id: 'markt_3', category: 'Markt', text: 'Wie hoch ist der Umsatzanteil Ihres größten Kunden?', options: [{ text: '< 15%', value: 1 }, { text: '15% - 30%', value: 3 }, { text: '> 30%', value: 5 }], help: { title: 'Kundenkonzentration', explanation: 'Ein "Klumpenrisiko" bei Kunden ist eine erhebliche Gefahr. Der Verlust eines einzigen Großkunden kann die Existenz des Unternehmens bedrohen. Ein diversifiziertes Kundenportfolio ist stabiler und für Käufer attraktiver.', calculation: '(Umsatz Kunde A / Gesamtumsatz) * 100', benchmarkGood: 'Kein einzelner Kunde macht mehr als 10-15% des Umsatzes aus.', benchmarkBad: 'Ein Kunde ist für über 50% des Umsatzes verantwortlich.' } },
                    { id: 'markt_4', category: 'Markt', text: 'Wie stark ist Ihre technologische Eintrittsbarriere für Wettbewerber?', options: [{ text: 'Sehr hoch durch Patente oder einzigartige, schwer kopierbare Technologie', value: 1 }, { text: 'Moderat, Wettbewerber benötigen signifikante Investitionen zum Nachziehen', value: 2 }, { text: 'Gering, unsere Technologie ist leicht zu replizieren', value: 4 }], help: { title: 'Technologische Barrieren', explanation: 'Hohe technologische Hürden schützen Ihr Geschäftsmodell vor Nachahmern und sichern Ihre Margen. Geringe Barrieren führen zu hohem Preisdruck und schnellem Wettbewerb.', benchmarkGood: 'Geschützte IP, einzigartige Algorithmen, hoher F&E-Vorsprung.', benchmarkBad: 'Standardsoftware, die mit Open-Source-Komponenten leicht nachgebaut werden kann.' } },
                    { id: 'markt_5', category: 'Markt', text: 'Wie systematisch und datengetrieben ist Ihr Vertriebsprozess?', options: [{ text: 'Vollständig datengetrieben mit CRM, definierten Sales-Funnel und KPIs', value: 1 }, { text: 'CRM wird genutzt, aber Prozesse sind nicht standardisiert', value: 3 }, { text: 'Vertrieb erfolgt unsystematisch und beziehungsgetrieben', value: 5 }], help: { title: 'Vertriebsprozess', explanation: 'Ein systematischer, skalierbarer Vertrieb ist ein wesentlicher Werttreiber. Ist der Vertrieb rein von den Beziehungen des Gründers abhängig, ist dies ein enormes Risiko und mindert den Wert erheblich.', benchmarkGood: 'Klare Metriken wie Customer Acquisition Cost (CAC) und Customer Lifetime Value (LTV) werden gemessen und optimiert.', benchmarkBad: 'Kein CRM-System, keine nachvollziehbaren Vertriebsaktivitäten.' } },
                    { id: 'markt_6', category: 'Markt', text: 'Wie würden Sie die Bekanntheit Ihrer Marke im Zielmarkt beschreiben?', options: [{ text: 'Hoch, wir sind eine anerkannte Marke in unserer Nische', value: 1 }, { text: 'Mittel, wir sind einigen potenziellen Kunden bekannt', value: 3 }, { text: 'Gering, wir sind weitgehend unbekannt', value: 4 }], help: { title: 'Markenbekanntheit', explanation: 'Eine starke Marke senkt die Kosten für die Neukundengewinnung und ermöglicht höhere Preise. Eine unbekannte Marke bedeutet, dass Sie bei jedem Kunden bei Null anfangen müssen.', benchmarkGood: 'Hohe organische Suchanfragen, regelmäßige Erwähnung in der Fachpresse.', benchmarkBad: 'Keine Marketingaktivitäten, reine Kaltakquise.' } },
                    { id: 'markt_7', category: 'Markt', text: 'Wie ist das Verhältnis von Customer Lifetime Value (LTV) zu Customer Acquisition Costs (CAC)?', options: [{ text: 'Sehr gut (LTV/CAC > 4)', value: 1 }, { text: 'Ausgeglichen (LTV/CAC zwischen 2 und 4)', value: 2 }, { text: 'Schlecht (LTV/CAC < 2) oder Kennzahlen unbekannt', value: 5 }], help: { title: 'LTV / CAC Ratio', explanation: 'Dieses Verhältnis ist ein zentraler Indikator für die Profitabilität und Skalierbarkeit Ihres Geschäftsmodells. Ein Wert unter 2 bedeutet, dass die Neukundengewinnung zu teuer ist und das Modell langfristig nicht tragfähig sein könnte.' } },
                    { id: 'markt_8', category: 'Markt', text: 'Wie ist Ihre Preisstrategie im Vergleich zum Wettbewerb aufgestellt?', options: [{ text: 'Value-Based Pricing: Preise orientieren sich am Kundennutzen und wir erzielen Premium-Margen', value: 1 }, { text: 'Competition-Based Pricing: Preise orientieren sich am Wettbewerb', value: 3 }, { text: 'Cost-Plus Pricing oder reiner Preiskampf', value: 4 }], help: { title: 'Preisstrategie', explanation: 'Eine ausgereifte, am Kundennutzen orientierte Preisstrategie ist ein Zeichen von Marktstärke und ermöglicht höhere Margen. Ein reiner Preiskampf deutet auf fehlende Differenzierung hin.' } },
                    { id: 'markt_9', category: 'Markt', text: 'Wie systematisch analysieren Sie Ihre Hauptwettbewerber?', options: [{ text: 'Regelmäßig und systematisch (Funktionen, Preise, Marketing, Kundenbewertungen)', value: 2 }, { text: 'Sporadisch, wenn ein Wettbewerber eine wichtige Neuerung veröffentlicht', value: 3 }, { text: 'Gar nicht, wir konzentrieren uns nur auf uns selbst', value: 4 }], help: { title: 'Wettbewerbsanalyse', explanation: 'Den Wettbewerb zu ignorieren ist riskant. Eine systematische Analyse hilft, Marktveränderungen frühzeitig zu erkennen, eigene Schwächen zu identifizieren und die eigene Strategie zu schärfen.' } },
                    { id: 'markt_10', category: 'Markt', text: 'Wie hoch ist der Anteil wiederkehrender Umsätze (Recurring Revenue)?', options: [{ text: '> 80% des Gesamtumsatzes', value: 1 }, { text: '40% - 80% des Gesamtumsatzes', value: 2 }, { text: '< 40% (überwiegend Projektgeschäft)', value: 4 }], help: { title: 'Wiederkehrende Umsätze (MRR/ARR)', explanation: 'Ein hoher Anteil an wiederkehrenden Umsätzen (z.B. aus SaaS-Abos) ist für Investoren extrem wertvoll, da er Planbarkeit und Stabilität signalisiert. Projektgeschäft ist deutlich volatiler und wird geringer bewertet.' } },
                    { id: 'markt_11', category: 'Markt', text: 'Wie diversifiziert sind Ihre Umsätze nach Regionen oder Ländern?', options: [{ text: 'Stark diversifiziert, kein Land macht mehr als 50% des Umsatzes aus', value: 2 }, { text: 'Erste Schritte im Ausland, aber starke Abhängigkeit vom Heimatmarkt (>80%)', value: 3 }, { text: 'Ausschließlich im Heimatmarkt (DACH) tätig', value: 4 }], help: { title: 'Geografische Diversifikation', explanation: 'Eine breite geografische Aufstellung reduziert die Abhängigkeit von einzelnen Volkswirtschaften und deren Konjunkturzyklen. Sie ist ein Zeichen für ein reifes und skalierbares Geschäftsmodell.' } },

                    // Finanzen (5 -> 9)
                    { id: 'fin_1', category: 'Finanzen', text: 'Wie ist Ihre "Cash-Burn-Rate" und wie viele Monate reicht Ihre Liquidität (Runway)?', options: [{ text: 'Positiver Cashflow oder Runway > 24 Monate', value: 1 }, { text: 'Runway zwischen 12 und 24 Monaten', value: 3 }, { text: 'Runway < 12 Monate oder unklar', value: 5 }], help: { title: 'Cash-Burn & Runway', explanation: 'Diese Kennzahl ist entscheidend für die finanzielle Stabilität, insbesondere für nicht-profitable Wachstumsunternehmen. Ein kurzer Runway bedeutet, dass bald neues Kapital benötigt wird, was ein erhebliches Risiko darstellt.', calculation: 'Verfügbare Liquidität / Netto-Cashflow pro Monat', benchmarkGood: 'Runway von über 18-24 Monaten, um strategische Flexibilität zu gewährleisten.', benchmarkBad: 'Weniger als 6 Monate Runway, erfordert sofortige Finanzierungsmaßnahmen.' } },
                    { id: 'fin_2', category: 'Finanzen', text: 'Existieren Finanz-Covenants (Kreditauflagen) und wie ist deren Einhaltung?', options: [{ text: 'Keine Covenants oder Einhaltung mit großem Puffer', value: 1 }, { text: 'Covenants vorhanden, Einhaltung wird eng überwacht', value: 3 }, { text: 'Bruch von Covenants droht oder ist bereits erfolgt', value: 5 }], help: { title: 'Finanz-Covenants', explanation: 'Covenants sind von Banken vorgegebene Finanzkennzahlen (z.B. Eigenkapitalquote, Verschuldungsgrad). Ein Bruch dieser Auflagen kann zur Kündigung von Krediten führen und ist ein massives finanzielles Risiko.', benchmarkGood: 'Regelmäßiges Reporting und vorausschauende Planung zur Einhaltung.', benchmarkBad: 'Fehlende Überwachung der Covenants.' } },
                    { id: 'fin_3', category: 'Finanzen', text: 'Wie hoch ist die durchschnittliche Forderungslaufzeit (Days Sales Outstanding - DSO)?', benchmarkKey: 'dso', options: [{ text: '< 30 Tage', value: 1 }, { text: '30 - 60 Tage', value: 3 }, { text: '> 60 Tage', value: 5 }], help: { title: 'Forderungslaufzeit (DSO)', explanation: 'Ein hoher DSO-Wert bedeutet, dass Ihr Geld lange bei Kunden "liegt" und nicht für Investitionen zur Verfügung steht. Es bindet Kapital (Working Capital) und erhöht das Risiko von Forderungsausfällen.', calculation: '(Durchschnittliche Forderungen / Umsatz der Periode) * 365 Tage', benchmarkGood: 'Unter 30 Tagen, nahe am vertraglichen Zahlungsziel.', benchmarkBad: 'Über 90 Tage, hohe Mahnquote.' } },
                    { id: 'fin_4', category: 'Finanzen', text: 'Wie professionell ist Ihr Finanz-Reporting und Controlling?', options: [{ text: 'Professionell mit Monatsabschlüssen, Forecasts und Soll-Ist-Vergleichen', value: 1 }, { text: 'Standard-BWA vom Steuerberater, keine interne Analyse', value: 3 }, { text: 'Reines "Kontoauszugs-Controlling", keine vorausschauende Planung', value: 5 }], help: { title: 'Finanz-Reporting', explanation: 'Ein professionelles Controlling ist die Basis für fundierte unternehmerische Entscheidungen. Ohne transparente und zeitnahe Finanzdaten agiert das Unternehmen im Blindflug.', benchmarkGood: 'Monatliche, aussagekräftige Reports mit KPIs, die innerhalb von 10 Arbeitstagen vorliegen.', benchmarkBad: 'Finanzdaten sind veraltet und nicht aussagekräftig.' } },
                    { id: 'fin_5', category: 'Finanzen', text: 'Wie ist die Profitabilität auf Produktebene (Deckungsbeitrag)?', options: [{ text: 'Deckungsbeiträge sind für alle Produkte bekannt und positiv', value: 1 }, { text: 'Teilweise bekannt, aber nicht systematisch gesteuert', value: 3 }, { text: 'Unbekannt, es wird nur der Gesamtgewinn betrachtet', value: 4 }], help: { title: 'Deckungsbeitragsrechnung', explanation: 'Ohne Kenntnis der Produkt-Profitabilität besteht die Gefahr, dass Sie mit unprofitablen Produkten viel Umsatz machen, der aber den Gesamtgewinn schmälert. Diese Transparenz ist für eine Wertsteigerung essenziell.', benchmarkGood: 'Etablierte Deckungsbeitragsrechnung, die als Basis für Vertriebs- und Preisentscheidungen dient.', benchmarkBad: 'Fokus liegt nur auf dem Umsatz, nicht auf der Marge.' } },
                    { id: 'fin_6', category: 'Finanzen', text: 'Wie hat sich Ihr Umsatz in den letzten 3 Jahren entwickelt?', options: [{ text: 'Starkes Wachstum (> 25% p.a.)', value: 1 }, { text: 'Moderates Wachstum (5% - 25% p.a.)', value: 2 }, { text: 'Stagnation oder Rückgang (< 5% p.a.)', value: 4 }], help: { title: 'Umsatzwachstum', explanation: 'Nachhaltiges und starkes Umsatzwachstum ist einer der wichtigsten Treiber für eine hohe Unternehmensbewertung. Stagnation deutet auf einen gesättigten Markt oder interne Probleme hin.' } },
                    { id: 'fin_7', category: 'Finanzen', text: 'Wie hoch ist Ihre Bruttomarge?', benchmarkKey: 'bruttomarge', options: [{ text: 'Hoch (> 80%)', value: 1 }, { text: 'Mittel (60% - 80%)', value: 2 }, { text: 'Niedrig (< 60%)', value: 4 }], help: { title: 'Bruttomarge', explanation: 'Die Bruttomarge (Umsatz abzüglich direkter Kosten der Leistungserbringung) zeigt die grundlegende Profitabilität Ihres Produkts. Eine hohe Marge ist typisch für skalierbare Software und sehr attraktiv für Investoren.', calculation: '(Rohertrag / Umsatz) * 100' } },
                    { id: 'fin_8', category: 'Finanzen', text: 'Wie hoch ist Ihr aktueller Verschuldungsgrad (Nettofinanzverbindlichkeiten / EBITDA)?', options: [{ text: 'Keine Nettoverschuldung oder unter 1.0x', value: 1 }, { text: 'Zwischen 1.0x und 3.0x', value: 3 }, { text: 'Über 3.0x oder nicht profitabel', value: 5 }], help: { title: 'Verschuldungsgrad', explanation: 'Ein hoher Verschuldungsgrad erhöht das finanzielle Risiko, da Zins- und Tilgungszahlungen die Liquidität belasten. Ein niedriger Wert signalisiert finanzielle Stabilität und Flexibilität.' } },
                    { id: 'fin_9', category: 'Finanzen', text: 'Wie ist Ihr Working Capital Management?', options: [{ text: 'Optimiert und cash-flow-positiv', value: 1 }, { text: 'Neutral, bindet aber kein übermäßiges Kapital', value: 3 }, { text: 'Negativ, es wird viel Kapital in Forderungen und Beständen gebunden', value: 4 }], help: { title: 'Working Capital', explanation: 'Ein hohes Working Capital (Umlaufvermögen ./. kurzfr. Verbindlichkeiten) bedeutet, dass viel Geld im operativen Geschäft gebunden ist, das nicht für Wachstum zur Verfügung steht. Effizientes Management ist ein Zeichen finanzieller Disziplin.' } },

                    // IT (5 -> 5) - Unverändert
                    { id: 'it_1', category: 'IT', text: 'Wie ist Ihr "Tech Stack" (eingesetzte Technologien) zu bewerten?', options: [{ text: 'Modern, gut dokumentiert, basierend auf gängigen Open-Source-Technologien', value: 1 }, { text: 'Funktional, aber teilweise veraltet oder mit exotischen Komponenten', value: 3 }, { text: 'Stark veraltet, proprietär, kaum noch Entwickler am Markt verfügbar', value: 5 }], help: { title: 'Technologie-Stack', explanation: 'Ein veralteter oder exotischer Tech Stack ist eine "technische Schuld", die ein Käufer teuer bezahlen muss. Es erschwert die Wartung, Weiterentwicklung und das Finden von qualifiziertem Personal. Das führt zu erheblichen Bewertungsabschlägen.', benchmarkGood: 'Gängige Frameworks wie React, Python/Django, Docker, Kubernetes.', benchmarkBad: 'Software geschrieben in Delphi oder VB6, keine Versionskontrolle.' } },
                    { id: 'it_2', category: 'IT', text: 'Gibt es ein systematisches IT-Sicherheitskonzept (z.B. regelmäßige Penetrationstests, Notfallplan)?', options: [{ text: 'Ja, mit externer Überprüfung und klaren Prozessen für den Ernstfall', value: 1 }, { text: 'Grundlegende Maßnahmen (Firewall, Virenscanner) sind vorhanden', value: 3 }, { text: 'Nein, Sicherheit wird nur bei Bedarf thematisiert', value: 5 }], help: { title: 'IT-Sicherheit', explanation: 'Für ein Software-Unternehmen ist die IT-Sicherheit existenziell. Ein erfolgreicher Hackerangriff kann zum Totalverlust von Daten, Reputation und Kunden führen. Fehlende Konzepte sind ein No-Go für jeden professionellen Investor.', benchmarkGood: 'ISO 27001 Zertifizierung, dedizierter Sicherheitsbeauftragter.', benchmarkBad: 'Keine Backups, Passwörter auf Post-its.' } },
                    { id: 'it_3', category: 'IT', text: 'Wie ist der Zugriff auf kritische Systeme (z.B. Produktionsserver, Datenbanken) geregelt?', options: [{ text: 'Nach dem "Least-Privilege"-Prinzip mit Multi-Faktor-Authentifizierung (MFA)', value: 1 }, { text: 'Zugriffsrechte sind vorhanden, aber nicht streng restriktiv', value: 3 }, { text: 'Viele Mitarbeiter haben weitreichende Admin-Rechte', value: 5 }], help: { title: 'Zugriffsmanagement', explanation: 'Ein unsicheres Zugriffsmanagement ist ein Einfallstor für Angriffe und menschliche Fehler. Nach dem "Least-Privilege"-Prinzip sollte jeder Mitarbeiter nur die Rechte haben, die er für seine Arbeit zwingend benötigt.', benchmarkGood: 'Rollenbasiertes Zugriffskonzept (RBAC), regelmäßige Überprüfung der Berechtigungen.', benchmarkBad: 'Alle Entwickler haben vollen Zugriff auf die Produktionsdatenbank.' } },
                    { id: 'it_4', category: 'IT', text: 'Wie häufig werden Ihre Software-Abhängigkeiten und Bibliotheken auf Sicherheitslücken geprüft und aktualisiert?', options: [{ text: 'Automatisiert und kontinuierlich (z.B. mit Dependabot, Snyk)', value: 1 }, { text: 'Manuell und sporadisch bei größeren Updates', value: 3 }, { text: 'Gar nicht, es wird nur bei akuten Problemen aktualisiert', value: 5 }], help: { title: 'Dependency Management', explanation: 'Veraltete Software-Bibliotheken sind eine der häufigsten Ursachen für Sicherheitslücken. Ein systematischer Prozess zur Aktualisierung dieser Abhängigkeiten ist essenziell für die IT-Sicherheit.', benchmarkGood: 'Automatisierte Scans im CI/CD-Prozess, klare Richtlinien für die Nutzung von Open-Source-Software.', benchmarkBad: 'Jahrelang keine Updates bei kritischen Bibliotheken.' } },
                    { id: 'it_5', category: 'IT', text: 'Ist eine Data-Governance-Richtlinie etabliert, um den Umgang mit sensiblen Daten zu regeln?', options: [{ text: 'Ja, es gibt klare Regeln zur Klassifizierung, Speicherung und Löschung von Daten', value: 2 }, { text: 'Es gibt Ansätze, aber keinen durchgängigen Prozess', value: 3 }, { text: 'Nein, es gibt keine formalen Regeln zum Umgang mit Daten', value: 4 }], help: { title: 'Data Governance', explanation: 'Data Governance stellt sicher, dass Daten über ihren gesamten Lebenszyklus hinweg korrekt, sicher und gesetzeskonform behandelt werden. Fehlende Regeln erhöhen das Risiko von Datenschutzverstößen und ineffizienten Prozessen.', benchmarkGood: 'Datenklassifizierungsschema (öffentlich, intern, vertraulich), definierte Datenverantwortliche (Data Owner).', benchmarkBad: 'Sensible Kundendaten werden unverschlüsselt in Excel-Listen gespeichert.' } },
                    
                    // Recht (5 -> 5) - Unverändert
                    { id: 'recht_1', category: 'Recht', text: 'Wie ist die Inhaberschaft des geistigen Eigentums (IP) an Ihrer Software geregelt?', options: [{ text: 'Alle IP-Rechte liegen nachweislich und ausschließlich bei der Gesellschaft', value: 1 }, { text: 'Unklare Regelungen bei Beiträgen von Freelancern oder Open Source Komponenten', value: 3 }, { text: 'Wesentliche Teile des Codes wurden von Dritten ohne klare Rechteübertragung entwickelt', value: 5 }], help: { title: 'Geistiges Eigentum (IP)', explanation: 'Der Wert eines Software-Unternehmens steckt im Code. Wenn nicht 100% klar ist, dass das Unternehmen alle Rechte daran besitzt, ist es quasi wertlos. Dies ist ein zentraler Punkt jeder Due-Diligence-Prüfung.', benchmarkGood: 'Wasserdichte Arbeits- und Dienstleistungsverträge mit expliziter IP-Übertragungsklausel.', benchmarkBad: 'Ex-Mitarbeiter oder Freelancer könnten Rechte am Kernprodukt beanspruchen.' } },
                    { id: 'recht_2', category: 'Recht', text: 'Wie stellen Sie die Einhaltung der DSGVO (GDPR) sicher?', options: [{ text: 'Durch einen etablierten Prozess, einen (externen) Datenschutzbeauftragten und regelmäßige Schulungen', value: 1 }, { text: 'Wir haben eine Datenschutzerklärung, aber keine aktiven Prozesse', value: 3 }, { text: 'Das Thema wird vernachlässigt', value: 5 }], help: { title: 'DSGVO-Compliance', explanation: 'Verstöße gegen die DSGVO können zu empfindlichen Bußgeldern und erheblichem Reputationsschaden führen. Ein systematischer Ansatz zur Einhaltung ist unerlässlich.', benchmarkGood: 'Verzeichnis von Verarbeitungstätigkeiten (VVT), Prozesse für Betroffenenrechte, technisch-organisatorische Maßnahmen (TOMs).', benchmarkBad: 'Kein Datenschutzbeauftragter, unklare Datenverarbeitung.' } },
                    { id: 'recht_3', category: 'Recht', text: 'Werden Ihre Kundenverträge und AGB regelmäßig anwaltlich geprüft und aktualisiert?', options: [{ text: 'Ja, mindestens alle 2 Jahre oder bei Gesetzesänderungen', value: 1 }, { text: 'Sporadisch, aber nicht systematisch', value: 3 }, { text: 'Nein, die Verträge sind seit Jahren unverändert', value: 5 }], help: { title: 'Vertragsmanagement', explanation: 'Veraltete Verträge können unwirksame Klauseln enthalten (z.B. zur Haftungsbeschränkung), was im Streitfall zu erheblichen finanziellen Risiken führen kann.', benchmarkGood: 'Zentrales Vertragsarchiv mit Fristenüberwachung.', benchmarkBad: 'AGB aus dem Internet kopiert.' } },
                    { id: 'recht_4', category: 'Recht', text: 'Gibt es einen formalen Prozess für den Umgang mit Datenpannen (Data Breach)?', options: [{ text: 'Ja, ein dokumentierter Notfallplan inklusive Meldeprozess an die Behörden existiert', value: 1 }, { text: 'Es gibt eine grobe Vorstellung, aber keinen schriftlichen Plan', value: 3 }, { text: 'Nein, wir würden im Ernstfall improvisieren', value: 5 }], help: { title: 'Umgang mit Datenpannen', explanation: 'Die DSGVO schreibt eine Meldepflicht für Datenpannen innerhalb von 72 Stunden vor. Ein fehlender Notfallplan erhöht das Risiko, diese Frist zu verpassen und ein Bußgeld zu erhalten.', benchmarkGood: 'Regelmäßige Tests des Notfallplans.', benchmarkBad: 'Keine klaren Zuständigkeiten für den Ernstfall.' } },
                    { id: 'recht_5', category: 'Recht', text: 'Wie werden die Verträge mit Cloud-Anbietern (AWS, Azure etc.) rechtlich geprüft?', options: [{ text: 'Sie werden vor Abschluss auf kritische Klauseln (Haftung, Gerichtsstand, Datenschutz) geprüft', value: 2 }, { text: 'Es werden nur die Standardverträge ohne Prüfung akzeptiert', value: 4 }, { text: 'Es gibt keine Verträge, es werden nur Dienste auf Abruf genutzt', value: 5 }], help: { title: 'Cloud-Verträge', explanation: 'Die Standardverträge großer Cloud-Anbieter enthalten oft für den Kunden nachteilige Klauseln, insbesondere bei Haftung und Datenschutz. Eine anwaltliche Prüfung ist ratsam.', benchmarkGood: 'Verhandlung individueller Zusatzvereinbarungen (Add-ons).', benchmarkBad: 'Blindes Akzeptieren der Standard-AGB.' } },
                ]
            },
            'maschinenbau': { 
                name: 'Maschinen- & Anlagenbau', 
                questions: [
                    // Organisation (5 -> 5) - Unverändert
                    { id: 'org_1', category: 'Organisation', text: 'Wie ist der Dokumentationsgrad Ihrer Kernprozesse (Konstruktion, Fertigung, Montage)?', options: [{ text: 'Vollständig, aktuell und für alle zugänglich (z.B. im ERP/PLM-System)', value: 1 }, { text: 'Teilweise vorhanden, aber nicht durchgängig gepflegt', value: 3 }, { text: 'Wissen steckt hauptsächlich in den Köpfen der Meister und Facharbeiter', value: 5 }], help: { title: 'Prozessdokumentation', explanation: 'Eine gute Dokumentation reduziert die Abhängigkeit von einzelnen Mitarbeitern, sichert die Fertigungsqualität und ist die Basis für Zertifizierungen (z.B. ISO 9001).', benchmarkGood: 'Detaillierte Arbeitsanweisungen, Stücklisten und Prüfprotokolle sind digital verfügbar.', benchmarkBad: 'Keine schriftlichen Anleitungen, Fertigung nach "Gefühl".' } },
                    { id: 'org_2', category: 'Organisation', text: 'Existiert ein zertifiziertes Qualitätsmanagementsystem (z.B. ISO 9001)?', options: [{ text: 'Ja, zertifiziert und im Unternehmen gelebt', value: 1 }, { text: 'Prozesse sind an ISO 9001 angelehnt, aber nicht zertifiziert', value: 3 }, { text: 'Nein, es gibt kein formales QM-System', value: 5 }], help: { title: 'Qualitätsmanagement', explanation: 'Ein QM-System wie ISO 9001 ist in vielen Branchen eine Voraussetzung, um überhaupt als Lieferant gelistet zu werden. Es belegt verlässliche Prozesse und eine hohe Produktqualität.', benchmarkGood: 'Gelebtes System mit kontinuierlicher Verbesserung (KVP).', benchmarkBad: 'Qualität wird erst am Ende geprüft, hohe Ausschussquoten.' } },
                    { id: 'org_3', category: 'Organisation', text: 'Wie wird die Instandhaltung Ihres Maschinenparks geplant und dokumentiert?', options: [{ text: 'Proaktiv mit einem digitalen Instandhaltungsplanungssystem (IPS)', value: 1 }, { text: 'Es gibt Wartungspläne, aber die Umsetzung ist nicht durchgängig', value: 3 }, { text: 'Reaktiv, Reparaturen erfolgen erst bei einem Ausfall', value: 5 }], help: { title: 'Instandhaltungsmanagement', explanation: 'Eine proaktive, vorausschauende Instandhaltung (Predictive Maintenance) minimiert ungeplante Stillstände, erhöht die Lebensdauer der Maschinen und sichert die Produktionskapazität.', benchmarkGood: 'Digitale Wartungspläne mit automatischer Überwachung der Maschinenstunden.', benchmarkBad: 'Häufige, unvorhergesehene Maschinenausfälle.' } },
                    { id: 'org_4', category: 'Organisation', text: 'Gibt es einen formalen Prozess für Produktänderungen und Neuentwicklungen (Change Management)?', options: [{ text: 'Ja, ein strukturierter Prozess von der Idee bis zur Serienreife ist etabliert', value: 1 }, { text: 'Es gibt Ansätze, aber der Prozess ist nicht standardisiert', value: 3 }, { text: 'Änderungen werden informell und unkoordiniert umgesetzt', value: 4 }], help: { title: 'Change Management', explanation: 'Ein unstrukturierter Änderungsprozess führt zu Fehlern, Verzögerungen und höheren Kosten. Ein formaler Prozess stellt sicher, dass alle relevanten Abteilungen (Konstruktion, Einkauf, Produktion) involviert sind.', benchmarkGood: 'Digitale Freigabeworkflows im PLM/ERP-System.', benchmarkBad: 'Änderungen an der Konstruktion werden "auf dem kleinen Dienstweg" gemacht.' } },
                    { id: 'org_5', category: 'Organisation', text: 'Wie verwalten Sie Ihr Lager für Ersatz- und Verschleißteile?', options: [{ text: 'Systematisch mit Bestandsüberwachung und definierten Mindestbeständen', value: 1 }, { text: 'Lagerhaltung basiert auf Erfahrungswerten, keine systematische Überwachung', value: 3 }, { text: 'Chaotisch, es ist oft unklar, welche Teile auf Lager sind', value: 5 }], help: { title: 'Ersatzteilmanagement', explanation: 'Ein ineffizientes Ersatzteilmanagement bindet unnötig Kapital (zu hohe Bestände) oder gefährdet die Produktion (zu niedrige Bestände).', benchmarkGood: 'ABC-Analyse zur Klassifizierung der Teile, automatisierte Bestellvorschläge.', benchmarkBad: 'Hohe Bestände an Ladenhütern und gleichzeitig fehlende kritische Teile.' } },
                    
                    // Personal (6 -> 6) - Unverändert
                    { id: 'pers_1', category: 'Personal', text: 'Wie hoch ist die Mitarbeiterfluktuation (gewollte Kündigungen) im gewerblichen Bereich pro Jahr?', benchmarkKey: 'fluktuation', options: [{ text: '< 5% pro Jahr', value: 1 }, { text: '5% - 10% pro Jahr', value: 3 }, { text: '> 10% pro Jahr', value: 5 }], help: { title: 'Mitarbeiterfluktuation', explanation: 'Eine hohe Fluktuation bei Facharbeitern ist ein enormes Problem. Sie verursacht hohe Kosten für die Einarbeitung und führt zum Verlust von seltenem Fertigungs-Know-how.', calculation: '(Anzahl Kündigungen durch Mitarbeiter / Durchschnittliche Mitarbeiterzahl) * 100', benchmarkGood: 'Stabile Stammbelegschaft, geringe Fluktuation.', benchmarkBad: 'Ständiger Wechsel an den CNC-Maschinen.' } },
                    { id: 'pers_2', category: 'Personal', text: 'Wie hoch ist die Abhängigkeit von Schlüsselpersonal (z.B. Schweiß-Spezialist, CNC-Programmierer)?', options: [{ text: 'Wissen ist durch Ausbildung und detaillierte Arbeitspläne auf mehrere Schultern verteilt', value: 1 }, { text: 'Einzelne Experten sind wichtig, aber es gibt Stellvertreter', value: 3 }, { text: 'Die Fertigung steht und fällt mit 1-2 Personen', value: 5 }], help: { title: 'Key-Man-Risk', explanation: 'Der Ausfall einer Schlüsselperson kann die Produktion lahmlegen. Ein Käufer bewertet dieses Risiko mit hohen Abschlägen.', benchmarkGood: 'Für jede Schlüsselqualifikation gibt es mindestens einen weiteren geschulten Mitarbeiter.', benchmarkBad: 'Nur ein einziger Mitarbeiter kann die wichtigste Maschine bedienen.' } },
                    { id: 'pers_3', category: 'Personal', text: 'Wie ist die Altersstruktur Ihrer Facharbeiter?', options: [{ text: 'Gut gemischt, erfahrene Mitarbeiter bilden junge Kollegen aus', value: 1 }, { text: 'Homogen, aber ohne akutes Risiko (z.B. alle zwischen 35-50)', value: 3 }, { text: 'Stark überaltert (>55 Jahre), es droht eine Rentenwelle ohne Nachwuchs', value: 5 }], help: { title: 'Altersstruktur', explanation: 'Eine überalterte Belegschaft führt zu einer Ruhestandswelle und dem Verlust von unersetzlicher Erfahrung. Fehlender Nachwuchs ist ein enormes Zukunftsrisiko.', benchmarkGood: 'Aktives Ausbildungsprogramm, hohe Übernahmequote.', benchmarkBad: 'Die Hälfte der Belegschaft geht in den nächsten 5-10 Jahren in Rente.' } },
                    { id: 'pers_4', category: 'Personal', text: 'Wie gehen Sie mit dem Fachkräftemangel um?', options: [{ text: 'Aktiv, durch Ausbildung, Kooperationen mit Hochschulen und Employer Branding', value: 1 }, { text: 'Reaktiv, wir suchen, wenn eine Stelle frei wird', value: 3 }, { text: 'Passiv, wir hoffen, dass sich jemand bewirbt', value: 5 }], help: { title: 'Fachkräftemangel', explanation: 'Eine passive Haltung beim Thema Recruiting führt zwangsläufig zu unbesetzten Stellen und damit zu Produktionsausfällen oder Auftragsverlusten.', benchmarkGood: 'Gezielte Social-Media-Kampagnen, Präsenz auf Karrieremessen, attraktive Arbeitgebermarke.', benchmarkBad: 'Veröffentlichung einer Stellenanzeige und abwarten.' } },
                    { id: 'pers_5', category: 'Personal', text: 'Gibt es Anreizsysteme zur Produktivitäts- oder Qualitätssteigerung?', options: [{ text: 'Ja, ein transparentes und faires Prämiensystem ist etabliert', value: 2 }, { text: 'Es gibt einen Jahresbonus ohne klaren Bezug zur Leistung', value: 3 }, { text: 'Nein, es gibt ausschließlich feste Gehälter', value: 4 }], help: { title: 'Anreizsysteme', explanation: 'Intelligente Anreizsysteme können die Motivation und das Qualitätsbewusstsein der Mitarbeiter signifikant steigern und somit direkt zur Profitabilität beitragen.', benchmarkGood: 'Teamprämien, die an messbare Ziele wie Ausschussquote oder Termintreue gekoppelt sind.', benchmarkBad: 'Keine Verbindung zwischen persönlicher Leistung und Vergütung.' } },
                    { id: 'pers_6', category: 'Personal', text: 'Werden regelmäßig dokumentierte Sicherheitsschulungen durchgeführt und die Unfallraten überwacht?', options: [{ text: 'Ja, es gibt ein umfassendes Arbeitssicherheitskonzept mit regelmäßigen Schulungen', value: 1 }, { text: 'Schulungen finden statt, aber nicht systematisch', value: 3 }, { text: 'Arbeitssicherheit wird nur reaktiv behandelt', value: 5 }], help: { title: 'Arbeitssicherheit', explanation: 'Mängel in der Arbeitssicherheit führen zu Arbeitsunfällen, Ausfallzeiten und potenziellen rechtlichen Konsequenzen. Ein proaktives Sicherheitsmanagement ist daher unerlässlich.', benchmarkGood: 'Zertifizierung nach ISO 45001, niedrige Unfallquote (BG-Statistik).', benchmarkBad: 'Häufige Arbeitsunfälle, fehlende persönliche Schutzausrüstung.' } },

                    // Markt (7 -> 12)
                    { id: 'markt_1', category: 'Markt', text: 'Wie hoch ist die Abhängigkeit von spezifischen Rohstoffpreisen (z.B. Stahl, Kupfer)?', options: [{ text: 'Gering, durch langfristige Verträge oder Weitergabe an Kunden abgesichert.', value: 1 }, { text: 'Moderat, Preisschwankungen wirken sich direkt auf die Marge aus.', value: 3 }, { text: 'Hoch, starke Preisanstiege können die Profitabilität gefährden.', value: 5 }], help: { title: 'Rohstoffabhängigkeit', explanation: 'Im Maschinenbau können die Kosten für Rohstoffe einen erheblichen Teil der Gesamtkosten ausmachen. Fehlende Absicherungsstrategien führen zu unkalkulierbaren Margenschwankungen.', benchmarkGood: 'Nutzung von Hedging-Instrumenten, flexible Preisklauseln in Kundenverträgen.', benchmarkBad: 'Volle Abhängigkeit vom Spotmarkt-Preis ohne Puffer.' } },
                    { id: 'markt_2', category: 'Markt', text: 'Wie hoch ist der Anteil an kundenindividuellen Sonderanfertigungen?', options: [{ text: '< 20% (hoher Anteil an Standardprodukten)', value: 1 }, { text: '20% - 60%', value: 3 }, { text: '> 60% (hoher Anteil an Projektgeschäft)', value: 5 }], help: { title: 'Produkt-Standardisierung', explanation: 'Ein hoher Anteil an Standardprodukten ermöglicht Skaleneffekte in Produktion und Service. Ein sehr hoher Anteil an Sonderanfertigungen kann zu komplexen, schwer skalierbaren Prozessen und geringeren Margen führen.', benchmarkGood: 'Modularer Produktbaukasten, der Kundenindividualität mit Standardkomponenten ermöglicht.', benchmarkBad: 'Jede Maschine ist ein Unikat, was die Komplexität und die Kosten in die Höhe treibt.' } },
                    { id: 'markt_3', category: 'Markt', text: 'Wie stark ist Ihr Geschäft von Konjunkturzyklen abhängig?', options: [{ text: 'Gering, durch hohen Serviceanteil oder antizyklische Kundensegmente.', value: 1 }, { text: 'Moderat, Umsätze schwanken mit der allgemeinen Wirtschaftslage.', value: 3 }, { text: 'Hoch, starke Abhängigkeit von Investitionsgüternachfrage (z.B. aus der Automobilindustrie).', value: 5 }], help: { title: 'Konjunkturabhängigkeit', explanation: 'Eine starke Abhängigkeit von der Konjunktur führt zu hohen Umsatz- und Ergebnisschwankungen. Ein diversifiziertes Geschäftsmodell, z.B. mit einem stabilen Servicegeschäft, reduziert dieses Risiko erheblich.', benchmarkGood: 'Umsatzverteilung auf verschiedene Branchen und Regionen mit unterschiedlichen Zyklen.', benchmarkBad: '90% des Umsatzes hängen von einer einzigen, stark zyklischen Branche ab.' } },
                    { id: 'markt_4', category: 'Markt', text: 'Wie ist Ihre Preisstrategie im Vergleich zum Wettbewerb?', options: [{ text: 'Premium-Preise aufgrund technologischer Führung oder starker Marke', value: 1 }, { text: 'Marktübliche Preise (Followship-Pricing)', value: 3 }, { text: 'Aggressive Preisstrategie, um Marktanteile zu gewinnen (Verdrängungswettbewerb)', value: 4 }], help: { title: 'Preisstrategie', explanation: 'Ihre Preisstrategie ist ein Indikator für Ihre Marktstellung. Können Sie hohe Preise durchsetzen, deutet das auf eine starke Marke und USPs hin. Stehen Sie unter konstantem Preisdruck, ist Ihre Position schwach.', benchmarkGood: 'Value-based Pricing, das sich am Nutzen für den Kunden orientiert.', benchmarkBad: 'Einziger Wettbewerbsvorteil ist ein niedriger Preis.' } },
                    { id: 'markt_5', category: 'Markt', text: 'Wie abhängig ist Ihr Unternehmen von einem einzelnen Lieferanten?', options: [{ text: 'Gering, für alle A-Teile existieren mindestens zwei Lieferanten (Dual Sourcing)', value: 1 }, { text: 'Mittel, für einige wichtige Komponenten gibt es nur einen Lieferanten (Single Sourcing)', value: 3 }, { text: 'Hoch, der Ausfall eines Lieferanten würde die Produktion lahmlegen', value: 5 }], help: { title: 'Lieferantenabhängigkeit', explanation: 'Eine hohe Abhängigkeit von einzelnen Lieferanten stellt ein enormes Risiko für die Lieferkette dar. Insolvenz, Produktionsprobleme oder politische Krisen beim Lieferanten können Ihren eigenen Betrieb zum Stillstand bringen.', benchmarkGood: 'Systematisches Lieferantenmanagement mit Risikobewertung und alternativen Lieferanten.', benchmarkBad: 'Keine Alternativen für kritische Zukaufteile.' } },
                    { id: 'markt_6', category: 'Markt', text: 'Wie abhängig sind Sie von einzelnen Vertriebskanälen oder -partnern?', options: [{ text: 'Gering, wir nutzen einen Mix aus Direktvertrieb, Händlern und Online-Kanälen', value: 1 }, { text: 'Mittel, ein Hauptkanal macht über 50% des Umsatzes aus', value: 3 }, { text: 'Hoch, fast der gesamte Umsatz wird über einen einzigen Partner generiert', value: 5 }], help: { title: 'Vertriebskanalabhängigkeit', explanation: 'Die Abhängigkeit von einem einzigen Vertriebspartner (z.B. einem großen Händler) ist ähnlich riskant wie die Abhängigkeit von einem Großkunden. Der Partner kann Preise drücken oder die Partnerschaft beenden.', benchmarkGood: 'Diversifizierte Vertriebsstrategie mit starkem Direktvertriebsanteil.', benchmarkBad: 'Der größte Händler droht mit Auslistung, wenn die Rabatte nicht erhöht werden.' } },
                    { id: 'markt_7', category: 'Markt', text: 'Wie gehen Sie mit Wettbewerbern aus Niedriglohnländern um?', options: [{ text: 'Durch technologische Überlegenheit, Service und Qualität (Qualitätsführerschaft)', value: 1 }, { text: 'Durch Preissenkungen, was unsere Marge unter Druck setzt', value: 4 }, { text: 'Wir haben keine klare Strategie und verlieren Marktanteile', value: 5 }], help: { title: 'Wettbewerbsstrategie', explanation: 'Ein reiner Preiswettbewerb gegen Anbieter aus Niedriglohnländern ist auf Dauer nicht zu gewinnen. Eine klare Strategie der Qualitäts- oder Technologieführerschaft ist entscheidend für den langfristigen Erfolg.', benchmarkGood: 'Fokus auf Nischen mit hohen Qualitätsanforderungen, starker Markenaufbau.', benchmarkBad: 'Ständiger Preiskampf mit Wettbewerbern.' } },
                    { id: 'markt_8', category: 'Markt', text: 'Wie hoch ist der Anteil des After-Sales-Service am Gesamtumsatz?', options: [{ text: 'Hoch (> 20%), was für stabile, wiederkehrende Einnahmen sorgt.', value: 1 }, { text: 'Mittel (10% - 20%)', value: 2 }, { text: 'Gering (< 10%) oder wird nicht separat erfasst.', value: 4 }], help: { title: 'After-Sales-Umsatz', explanation: 'Ein starkes Servicegeschäft (Wartung, Ersatzteile) ist weniger konjunkturanfällig als der Verkauf von Neumaschinen. Es sorgt für stabile Cashflows und eine hohe Kundenbindung, was von Investoren sehr geschätzt wird.' } },
                    { id: 'markt_9', category: 'Markt', text: 'Wie hoch ist Ihre aktuelle Auftragsreichweite?', options: [{ text: 'Sehr hoch (> 12 Monate)', value: 1 }, { text: 'Solide (6 - 12 Monate)', value: 2 }, { text: 'Gering (< 6 Monate)', value: 4 }], help: { title: 'Auftragsreichweite', explanation: 'Ein hoher Auftragsbestand sichert die Auslastung und den Umsatz für die Zukunft. Eine geringe Reichweite deutet auf eine schwache Auftragslage oder eine hohe Volatilität hin.' } },
                    { id: 'markt_10', category: 'Markt', text: 'Wie ist Ihre Marktposition im Kernsegment?', options: [{ text: 'Marktführer (Top 3) mit signifikantem Marktanteil.', value: 1 }, { text: 'Etablierter Nischenanbieter mit starker Position in der Nische.', value: 2 }, { text: 'Einer von vielen Wettbewerbern ohne klare Differenzierung.', value: 4 }], help: { title: 'Marktposition', explanation: 'Eine führende Marktposition ist ein klarer Wettbewerbsvorteil. Sie ermöglicht Skaleneffekte, Preisdurchsetzungsmacht und eine höhere Markenbekanntheit. Eine schwache Position führt oft zu hohem Preisdruck.' } },
                    { id: 'markt_11', category: 'Markt', text: 'Wie stark ist die Verhandlungsmacht Ihrer Kunden?', options: [{ text: 'Gering, aufgrund unserer einzigartigen Technologie oder starken Marke.', value: 1 }, { text: 'Moderat, es gibt alternative Anbieter, aber ein Wechsel ist aufwendig.', value: 3 }, { text: 'Hoch, Kunden können leicht zu günstigeren Wettbewerbern wechseln.', value: 5 }], help: { title: 'Verhandlungsmacht der Kunden', explanation: 'Eine hohe Verhandlungsmacht der Kunden (z.B. durch große Einkaufsvolumina oder viele Alternativen) drückt auf Ihre Margen und kann die Vertragsbedingungen diktieren. Geringe Macht ist ein Zeichen einer starken Wettbewerbsposition.' } },
                    { id: 'markt_12', category: 'Markt', text: 'Wie abhängig ist Ihr Geschäft von politischen Entscheidungen oder Förderprogrammen?', options: [{ text: 'Gering, unser Geschäft ist von der Politik weitgehend unabhängig.', value: 1 }, { text: 'Mittel, Förderprogramme (z.B. für Energieeffizienz) beeinflussen die Nachfrage.', value: 3 }, { text: 'Hoch, politische Entscheidungen (z.B. Zölle, Regularien) haben direkten, starken Einfluss.', value: 4 }], help: { title: 'Politische Abhängigkeit', explanation: 'Eine hohe Abhängigkeit von politischen Rahmenbedingungen birgt Risiken, da diese sich schnell und unvorhersehbar ändern können. Dies führt zu Planungsunsicherheit.' } },

                    // Finanzen (5 -> 9)
                    { id: 'fin_1', category: 'Finanzen', text: 'Wie hoch ist der Anteil an langfristigen Finanzierungen für Ihren Maschinenpark?', options: [{ text: 'Überwiegend langfristig (>5 Jahre) finanziert.', value: 1 }, { text: 'Gemischte Finanzierungsstruktur.', value: 3 }, { text: 'Überwiegend kurzfristig finanziert, hohes Refinanzierungsrisiko.', value: 5 }], help: { title: 'Finanzierungsstruktur', explanation: 'Anlagevermögen sollte grundsätzlich langfristig finanziert sein (Goldene Bilanzregel). Eine kurzfristige Finanzierung von langlebigen Maschinen birgt erhebliche Refinanzierungs- und Zinsänderungsrisiken.', benchmarkGood: 'Langfristige Darlehen und Leasingverträge mit festen Konditionen.', benchmarkBad: 'Finanzierung des Maschinenparks über den Kontokorrentkredit.' } },
                    { id: 'fin_2', category: 'Finanzen', text: 'Wie hoch ist die Eigenkapitalquote Ihres Unternehmens?', benchmarkKey: 'ekQuote', options: [{ text: '> 30%', value: 1 }, { text: '15% - 30%', value: 3 }, { text: '< 15%', value: 5 }], help: { title: 'Eigenkapitalquote', explanation: 'Eine hohe Eigenkapitalquote ist das finanzielle Rückgrat eines Unternehmens. Sie zeugt von Stabilität, Krisenfestigkeit und Unabhängigkeit von Banken.', calculation: '(Eigenkapital / Bilanzsumme) * 100', benchmarkGood: 'Über 30-40%, schafft Vertrauen bei Banken und Lieferanten.', benchmarkBad: 'Unter 15%, hohes Insolvenzrisiko bei unvorhergesehenen Ereignissen.' } },
                    { id: 'fin_3', category: 'Finanzen', text: 'Wie hoch ist die Lagerumschlagshäufigkeit (Days Inventory Outstanding - DIO)?', benchmarkKey: 'dio', options: [{ text: '< 60 Tage', value: 1 }, { text: '60 - 120 Tage', value: 3 }, { text: '> 120 Tage', value: 5 }], help: { title: 'Lagerdauer (DIO)', explanation: 'Ein hohes Warenlager bindet extrem viel Kapital, verursacht Lagerkosten und birgt das Risiko der Veralterung (Ladenhüter).', calculation: '(Durchschnittlicher Lagerbestand / Materialaufwand) * 365 Tage', benchmarkGood: 'Hoher Umschlag, Just-in-Time-Ansätze.', benchmarkBad: 'Großes Lager mit vielen Teilen, die seit über einem Jahr nicht bewegt wurden.' } },
                    { id: 'fin_4', category: 'Finanzen', text: 'Wie detailliert ist Ihre Projekt- und Nachkalkulation?', options: [{ text: 'Sehr detailliert, Soll-Ist-Vergleiche für alle Projekte', value: 1 }, { text: 'Nur für Großprojekte vorhanden', value: 3 }, { text: 'Kaum vorhanden, Profitabilität wird nur geschätzt', value: 5 }], help: { title: 'Projektkalkulation', explanation: 'Eine genaue Kalkulation ist entscheidend, um die Profitabilität einzelner Aufträge sicherzustellen und fundierte Angebotsentscheidungen zu treffen. Ohne sie besteht die Gefahr, unrentable Aufträge anzunehmen.', benchmarkGood: 'Standardisierter Prozess mit digitaler Erfassung von Zeiten und Material.', benchmarkBad: 'Kalkulation basiert auf Erfahrungswerten ohne systematische Überprüfung.' } },
                    { id: 'fin_5', category: 'Finanzen', text: 'Gibt es Absicherungsstrategien gegen Währungsschwankungen (Hedging)?', options: [{ text: 'Ja, wir sichern einen Großteil unseres Fremdwährungsrisikos systematisch ab', value: 2 }, { text: 'Teilweise oder sporadisch', value: 3 }, { text: 'Nein, wir sind dem Währungsrisiko voll ausgesetzt', value: 5 }], help: { title: 'Währungsabsicherung', explanation: 'Bei einem hohen Exportanteil können Währungsschwankungen die Margen unvorhersehbar beeinflussen. Eine fehlende Absicherung stellt ein signifikantes finanzielles Risiko dar.', benchmarkGood: 'Einsatz von Devisentermingeschäften oder Währungsoptionen.', benchmarkBad: 'Keine Strategie zur Steuerung von Währungsrisiken.' } },
                    { id: 'fin_6', category: 'Finanzen', text: 'Wie hat sich Ihre Profitabilität (EBITDA-Marge) in den letzten 3 Jahren entwickelt?', options: [{ text: 'Stabil oder steigend', value: 1 }, { text: 'Leicht rückläufig oder stark schwankend', value: 3 }, { text: 'Stark rückläufig', value: 5 }], help: { title: 'Profitabilitätsentwicklung', explanation: 'Eine stabile oder steigende Profitabilität ist ein Zeichen für ein gesundes Unternehmen mit Preissetzungsmacht und Kostenkontrolle. Sinkende Margen sind ein Alarmsignal.' } },
                    { id: 'fin_7', category: 'Finanzen', text: 'Wie hoch ist die Kapitalintensität Ihres Geschäfts (CAPEX / Umsatz)?', options: [{ text: 'Gering (< 3%), es sind nur geringe Ersatz- und Erweiterungsinvestitionen nötig.', value: 1 }, { text: 'Moderat (3% - 7%)', value: 3 }, { text: 'Hoch (> 7%), das Geschäftsmodell erfordert ständig hohe Investitionen.', value: 5 }], help: { title: 'Kapitalintensität (CAPEX)', explanation: 'Ein kapitalintensives Geschäftsmodell erfordert ständig hohe Investitionen in den Maschinenpark, was den freien Cashflow reduziert. Ein geringer Investitionsbedarf ist für Investoren attraktiver.' } },
                    { id: 'fin_8', category: 'Finanzen', text: 'Existiert eine integrierte Finanzplanung (GuV, Bilanz, Cashflow) für die nächsten 3-5 Jahre?', options: [{ text: 'Ja, eine detaillierte, integrierte Planung wird regelmäßig aktualisiert.', value: 1 }, { text: 'Es existiert eine reine Umsatz- und Kostenplanung, aber keine integrierte Logik.', value: 3 }, { text: 'Nein, es wird nur kurzfristig geplant.', value: 5 }], help: { title: 'Integrierte Finanzplanung', explanation: 'Eine professionelle, integrierte Finanzplanung ist die Grundlage für strategische Entscheidungen. Sie zeigt die zukünftige Entwicklung von Gewinn, Liquidität und Verschuldung auf und ist ein Zeichen für hohe finanzielle Kompetenz.' } },
                    { id: 'fin_9', category: 'Finanzen', text: 'Wie ist die Qualität Ihrer Forderungen zu bewerten?', options: [{ text: 'Ausgezeichnet, Forderungsausfälle sind vernachlässigbar (< 0.5% vom Umsatz).', value: 1 }, { text: 'Gut, vereinzelte Ausfälle, die aber im Rahmen bleiben (0.5% - 2%).', value: 3 }, { text: 'Kritisch, es gibt regelmäßig signifikante Forderungsausfälle (> 2%).', value: 5 }], help: { title: 'Forderungsqualität', explanation: 'Häufige Forderungsausfälle deuten auf mangelhafte Bonitätsprüfungen der Kunden oder auf Probleme bei der Produkt- oder Servicequalität hin. Sie belasten direkt den Gewinn und die Liquidität.' } },

                    // IT (4 -> 4) - Unverändert
                    { id: 'it_1', category: 'IT', text: 'Inwieweit sind Ihre Produktions- und Geschäftsprozesse digitalisiert (Industrie 4.0)?', options: [{ text: 'Weitgehend automatisiert und vernetzt (z.B. durchgängiges ERP-PLM-MES)', value: 1 }, { text: 'Teilweise digitalisiert, viele Insellösungen mit manuellen Brüchen', value: 3 }, { text: 'Überwiegend manuelle Prozesse, Planung mit Excel und Papier', value: 5 }], help: { title: 'Digitalisierungsgrad', explanation: 'Manuelle Prozesse sind fehleranfällig, langsam und nicht skalierbar. Ein Mangel an Digitalisierung ist eine große Investitionshürde für einen Käufer.', benchmarkGood: 'Digitale Betriebsdatenerfassung (BDE), papierlose Fertigung.', benchmarkBad: 'Stundenzettel auf Papier, Konstruktionszeichnungen werden per E-Mail versendet.' } },
                    { id: 'it_2', category: 'IT', text: 'Wie ist die Trennung zwischen Ihrem Büro-Netzwerk (IT) und Ihrem Produktions-Netzwerk (OT) umgesetzt?', options: [{ text: 'Strikte Netzwerksegmentierung mit Firewalls und kontrollierten Übergängen', value: 1 }, { text: 'Logische Trennung, aber keine strikten Sicherheitsmaßnahmen', value: 3 }, { text: 'IT und OT befinden sich im selben, unsegmentierten Netzwerk', value: 5 }], help: { title: 'IT/OT-Sicherheit', explanation: 'Ein ungesichertes Produktionsnetzwerk (Operational Technology) ist ein massives Sicherheitsrisiko. Ein Angriff auf die IT könnte auf die Maschinensteuerung übergreifen und die Produktion lahmlegen.', benchmarkGood: 'Netzwerksegmentierung nach dem Purdue-Modell.', benchmarkBad: 'Produktionsmaschinen sind direkt aus dem Internet erreichbar.' } },
                    { id: 'it_3', category: 'IT', text: 'Wie sicher ist der Fernwartungszugang von externen Dienstleistern auf Ihre Maschinen?', options: [{ text: 'Gesichert über VPN mit Multi-Faktor-Authentifizierung und zeitlich begrenzten Zugängen', value: 1 }, { text: 'Zugang erfolgt über Standard-Software (z.B. TeamViewer) ohne spezielle Absicherung', value: 3 }, { text: 'Dienstleister haben permanenten, unkontrollierten Zugriff', value: 5 }], help: { title: 'Fernwartungssicherheit', explanation: 'Ungesicherte Fernwartungszugänge sind ein beliebtes Einfallstor für Cyber-Angriffe. Ein Angreifer könnte den Zugang kapern und Ihre Maschinen manipulieren oder lahmlegen.', benchmarkGood: 'Dedizierte Fernwartungslösung mit Logging und Freigabeprozessen.', benchmarkBad: 'Geteilte Passwörter für Fernwartungszugänge.' } },
                    { id: 'it_4', category: 'IT', text: 'Wie werden die von Ihren Maschinen generierten Daten (IoT-Daten) genutzt und geschützt?', options: [{ text: 'Systematische Erfassung und Analyse zur Prozessoptimierung, sichere Speicherung', value: 2 }, { text: 'Daten werden erfasst, aber kaum systematisch genutzt oder geschützt', value: 4 }, { text: 'Es werden keine Maschinendaten erfasst oder genutzt', value: 5 }], help: { title: 'Nutzung von IoT-Daten', explanation: 'Maschinendaten sind ein wertvoller Schatz zur Steigerung der Effizienz und Entwicklung neuer Geschäftsmodelle (z.B. Predictive Maintenance). Werden sie nicht genutzt, wird Potenzial verschenkt.', benchmarkGood: 'Einsatz einer IoT-Plattform zur Datenanalyse und -visualisierung.', benchmarkBad: 'Keine Nutzung der anfallenden Daten.' } },

                    // Recht (5 -> 5) - Unverändert
                    { id: 'recht_1', category: 'Recht', text: 'Wie aktuell und geprüft sind Ihre Allgemeinen Geschäftsbedingungen (AGB)?', options: [{ text: 'Aktuell (max. 2-3 Jahre alt) und von einem Fachanwalt erstellt/geprüft', value: 1 }, { text: 'Älter als 5 Jahre oder aus einer Vorlage selbst erstellt', value: 3 }, { text: 'Keine AGB vorhanden oder sehr veraltet (>10 Jahre)', value: 5 }], help: { title: 'AGB-Aktualität', explanation: 'Veraltete oder unwirksame AGB sind ein erhebliches rechtliches Risiko. Sie können dazu führen, dass Haftungsbeschränkungen oder Eigentumsvorbehalte nicht greifen.', benchmarkGood: 'Regelmäßige Prüfung und Anpassung an die aktuelle Rechtsprechung.', benchmarkBad: 'AGB aus dem Internet kopiert ohne anwaltliche Prüfung.' } },
                    { id: 'recht_2', category: 'Recht', text: 'Wie ist die Produkthaftung versichert?', options: [{ text: 'Umfassende, branchengerechte Produkthaftpflichtversicherung mit ausreichender Deckungssumme', value: 1 }, { text: 'Standard-Betriebshaftpflicht, Deckungssumme möglicherweise zu gering', value: 3 }, { text: 'Keine oder nur eine unzureichende Versicherung für Produkthaftungsfälle', value: 5 }], help: { title: 'Produkthaftung', explanation: 'Ein Fehler in einer Maschine kann Schäden in Millionenhöhe verursachen. Eine unzureichende Versicherung kann zur Insolvenz führen.', benchmarkGood: 'Deckungssumme von > 5 Mio. €, die auch Exporte in kritische Märkte (z.B. USA) abdeckt.', benchmarkBad: 'Minimale Deckungssumme, die im Ernstfall nicht ausreicht.' } },
                    { id: 'recht_3', category: 'Recht', text: 'Wie stellen Sie die Einhaltung von Exportkontrollvorschriften sicher?', options: [{ text: 'Durch einen systematischen Prozess und geschulte Mitarbeiter', value: 2 }, { text: 'Es wird auf Zuruf geprüft, aber ohne festen Prozess', value: 4 }, { text: 'Exportkontrolle ist kein Thema bei uns', value: 5 }], help: { title: 'Exportkontrolle', explanation: 'Verstöße gegen Exportkontrollgesetze (z.B. bei Dual-Use-Gütern) können zu hohen Strafen, dem Entzug von Genehmigungen und erheblichen Reputationsschäden führen.', benchmarkGood: 'Einsatz von spezialisierter Software zur Prüfung von Sanktionslisten.', benchmarkBad: 'Keine Prüfung, ob Produkte oder Kunden von Sanktionen betroffen sind.' } },
                    { id: 'recht_4', category: 'Recht', text: 'Wurde die Einhaltung des Lieferkettensorgfaltspflichtengesetzes (LkSG) geprüft und umgesetzt?', options: [{ text: 'Ja, wir haben eine Risikoanalyse durchgeführt und entsprechende Maßnahmen etabliert', value: 1 }, { text: 'Wir sind uns der Thematik bewusst, haben aber noch keine Maßnahmen ergriffen', value: 3 }, { text: 'Das Gesetz ist für uns nicht relevant oder wurde ignoriert', value: 5 }], help: { title: 'Lieferkettengesetz (LkSG)', explanation: 'Das LkSG verpflichtet Unternehmen ab einer bestimmten Größe zur Einhaltung von Menschenrechts- und Umweltstandards in ihrer Lieferkette. Verstöße können zu Bußgeldern und dem Ausschluss von öffentlichen Aufträgen führen.', benchmarkGood: 'Verankerung der LkSG-Anforderungen in Lieferantenverträgen, Durchführung von Lieferantenaudits.', benchmarkBad: 'Keine Transparenz über die eigene Lieferkette.' } },
                    { id: 'recht_5', category: 'Recht', text: 'Gibt es ein systematisches Management von internationalen Produktzertifizierungen (z.B. CE, UL, CSA)?', options: [{ text: 'Ja, ein zentraler Prozess überwacht die Gültigkeit und Erneuerung aller Zertifikate', value: 1 }, { text: 'Zertifikate werden bei Bedarf erworben, aber nicht systematisch verwaltet', value: 3 }, { text: 'Wir haben keine Übersicht über unsere Zertifizierungen', value: 4 }], help: { title: 'Zertifizierungsmanagement', explanation: 'Fehlende oder abgelaufene Zertifikate können zu einem Verkaufsverbot in wichtigen Märkten führen. Ein professionelles Management dieser Anforderungen ist daher essenziell.', benchmarkGood: 'Zentrale Datenbank mit allen Zertifikaten und deren Gültigkeitsdauer.', benchmarkBad: 'Verkauf in Märkte ohne die erforderlichen Zulassungen.' } },
                ]
            }
        };
        const categoryIcons = {
            'Markt': <Building2 className="w-6 h-6 mr-3 text-sky-600" />,
            'Organisation': <Briefcase className="w-6 h-6 mr-3 text-emerald-600" />,
            'IT': <Cpu className="w-6 h-6 mr-3 text-violet-600" />,
            'Finanzen': <Landmark className="w-6 h-6 mr-3 text-gray-600" />,
            'Recht': <ShieldCheck className="w-6 h-6 mr-3 text-rose-600" />,
            'Personal': <Users className="w-6 h-6 mr-3 text-orange-500" />
        };
        
        // --- REACT COMPONENTS ---

        function Countdown({ onCountdownEnd }) {
            const calculateTimeLeft = () => {
                const difference = +new Date('2025-07-04T13:45:00') - +new Date();
                let timeLeft = {};

                if (difference > 0) {
                    timeLeft = {
                        Tage: Math.floor(difference / (1000 * 60 * 60 * 24)),
                        Stunden: Math.floor((difference / (1000 * 60 * 60)) % 24),
                        Minuten: Math.floor((difference / 1000 / 60) % 60),
                        Sekunden: Math.floor((difference / 1000) % 60)
                    };
                }
                return timeLeft;
            };

            const [timeLeft, setTimeLeft] = useState(calculateTimeLeft());

            useEffect(() => {
                const timer = setTimeout(() => {
                    const newTimeLeft = calculateTimeLeft();
                    setTimeLeft(newTimeLeft);
                    if (Object.keys(newTimeLeft).length === 0) {
                        onCountdownEnd();
                    }
                }, 1000);

                return () => clearTimeout(timer);
            });

            const timerComponents = [];

            Object.keys(timeLeft).forEach(interval => {
                if (!timeLeft[interval] && timeLeft[interval] !== 0) {
                    return;
                }

                timerComponents.push(
                    <div key={interval} className="text-center">
                        <span className="text-4xl sm:text-6xl font-bold text-gray-800">{String(timeLeft[interval]).padStart(2, '0')}</span>
                        <span className="block text-sm sm:text-lg uppercase text-gray-500">{interval}</span>
                    </div>
                );
            });

            return (
                <div className="flex justify-center space-x-4 sm:space-x-8 my-8">
                    {timerComponents.length ? timerComponents : <span>Die Zeit ist abgelaufen!</span>}
                </div>
            );
        }

        function PasswordScreen({ onUnlock }) {
            const [password, setPassword] = useState('');
            const [error, setError] = useState('');
            const correctPassword = "FRIES"; // Hardcoded password

            const handleSubmit = (e) => {
                e.preventDefault();
                if (password === correctPassword) {
                    setError('');
                    onUnlock();
                } else {
                    setError('Falsches Passwort. Bitte versuchen Sie es erneut.');
                    setPassword('');
                }
            };
            
            return (
                <div className="w-full max-w-sm">
                    <form onSubmit={handleSubmit} className="bg-white p-8 rounded-xl shadow-2xl border border-gray-200">
                        <h3 className="text-center text-lg font-semibold text-gray-700 mb-4">Vorzeitiger Zugang</h3>
                        <div className="mb-4">
                            <label htmlFor="password" className="block text-gray-700 text-sm font-bold mb-2">
                                Passwort
                            </label>
                            <div className="relative">
                                <span className="absolute inset-y-0 left-0 flex items-center pl-3">
                                    <Lock className="h-5 w-5 text-gray-400" />
                                </span>
                                <input
                                    id="password"
                                    type="password"
                                    value={password}
                                    onChange={(e) => setPassword(e.target.value)}
                                    className="shadow-sm appearance-none border rounded-lg w-full py-3 pl-10 pr-3 text-gray-700 leading-tight focus:outline-none focus:ring-2 focus:ring-emerald-500 focus:border-transparent"
                                    placeholder="******"
                                />
                            </div>
                        </div>
                        {error && <p className="text-red-500 text-xs italic mb-4">{error}</p>}
                        <div className="flex items-center justify-center">
                            <button className="bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-2 px-4 rounded-lg focus:outline-none focus:shadow-outline w-full flex items-center justify-center" type="submit">
                                Entsperren
                                <ArrowRight className="ml-2 w-5 h-5" />
                            </button>
                        </div>
                    </form>
                </div>
            );
        }

        function HelpPanel({ content, benchmark, onClose }) {
            if (!content) return null;

            return (
                <div className="fixed inset-0 bg-black bg-opacity-60 flex justify-end z-50" onClick={onClose}>
                    <div className="w-full max-w-md bg-white h-full shadow-2xl p-6 overflow-y-auto slide-in-right" onClick={e => e.stopPropagation()}>
                        <div className="flex justify-between items-center mb-4">
                            <h3 className="text-xl font-bold text-gray-800 flex items-center"><Info className="w-6 h-6 mr-3 text-emerald-600" />{content.title}</h3>
                            <button onClick={onClose} className="text-gray-400 hover:text-gray-600"><X className="w-6 h-6" /></button>
                        </div>
                        <div className="prose max-w-none">
                            <p className="text-gray-600">{content.explanation}</p>
                            
                            {benchmark && (
                                <div className="mt-4 p-3 bg-emerald-50 border border-emerald-200 rounded-lg">
                                    <h4 className="font-semibold text-emerald-800 flex items-center"><BarChart3 className="w-4 h-4 mr-2" />Branchen-Benchmark</h4>
                                    <p className="text-sm text-emerald-700">
                                        Zum Vergleich: Der Durchschnitt für die Kennzahl <strong>"{benchmark.label}"</strong> liegt bei ca. <strong>{benchmark.value}</strong> (Quelle: {benchmark.source}).
                                    </p>
                                </div>
                            )}

                            {content.calculation && (
                                <div className="mt-4">
                                    <h4 className="font-semibold text-gray-700">Berechnung</h4>
                                    <p className="text-sm text-gray-500 bg-gray-50 p-2 rounded-md font-mono">{content.calculation}</p>
                                </div>
                            )}
                            {content.benchmarkGood && (
                                <div className="mt-4">
                                    <h4 className="font-semibold text-gray-700">Benchmark: Gutes Unternehmen</h4>
                                    <p className="text-sm text-gray-600 border-l-4 border-green-500 pl-3 py-1">{content.benchmarkGood}</p>
                                </div>
                            )}
                            {content.benchmarkBad && (
                                <div className="mt-4">
                                    <h4 className="font-semibold text-gray-700">Benchmark: Schlechtes Unternehmen</h4>
                                    <p className="text-sm text-gray-600 border-l-4 border-red-500 pl-3 py-1">{content.benchmarkBad}</p>
                                </div>
                            )}
                        </div>
                    </div>
                </div>
            );
        }

        function ClientInfo({ onNext, onLoad }) {
            const [clientName, setClientName] = useState('');
            const [revenue, setRevenue] = useState('');
            const [employeeCount, setEmployeeCount] = useState('');
            const fileInputRef = useRef(null);
        
            const handleSubmit = (e) => {
                e.preventDefault();
                if (clientName.trim() && revenue && employeeCount) {
                    onNext({ name: clientName.trim(), revenue, employeeCount });
                }
            };
            
            const handleFileChange = (event) => {
                const file = event.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = (e) => {
                        try {
                            const data = JSON.parse(e.target.result);
                            onLoad(data);
                        } catch (error) {
                            console.error("Fehler beim Laden der Analysedatei:", error);
                            alert("Die ausgewählte Datei ist keine gültige Analyse-Datei.");
                        }
                    };
                    reader.readAsText(file);
                }
            };

            const handleLoadClick = () => {
                fileInputRef.current.click();
            };
        
            return (
                 <div className="w-full max-w-2xl mx-auto">
                    <div className="text-center">
                        <Users className="w-16 h-16 mx-auto text-emerald-600 mb-4" />
                        <h2 className="text-3xl font-bold text-gray-800">Risikoanalyse</h2>
                        <p className="mt-2 text-lg text-gray-600">Bitte geben Sie die Unternehmensdaten ein oder laden Sie eine bestehende Analyse.</p>
                    </div>
                    <form onSubmit={handleSubmit} className="mt-10 space-y-6">
                         <div>
                            <label htmlFor="client-name" className="block text-sm font-medium text-gray-700">
                                Projektname
                            </label>
                            <div className="mt-1">
                                <input
                                    type="text"
                                    name="client-name"
                                    id="client-name"
                                    value={clientName}
                                    onChange={(e) => setClientName(e.target.value)}
                                    className="block w-full pl-3 pr-10 py-3 text-base border-gray-300 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm rounded-md shadow-sm"
                                    placeholder="z.B. Mustermann GmbH"
                                />
                            </div>
                        </div>

                         <div>
                            <label htmlFor="revenue" className="block text-sm font-medium text-gray-700">
                                Umsatzgröße (pro Jahr)
                            </label>
                            <select id="revenue" value={revenue} onChange={e => setRevenue(e.target.value)} className="mt-1 block w-full pl-3 pr-10 py-3 text-base border-gray-300 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm rounded-md shadow-sm">
                                <option value="" disabled>Bitte wählen...</option>
                                <option value="<1m">weniger als 1 Mio. €</option>
                                <option value="1-5m">1 - 5 Mio. €</option>
                                <option value="5-10m">5 - 10 Mio. €</option>
                                <option value="10-50m">10 - 50 Mio. €</option>
                                <option value=">50m">mehr als 50 Mio. €</option>
                            </select>
                        </div>

                         <div>
                            <label htmlFor="employee-count" className="block text-sm font-medium text-gray-700">
                                Mitarbeiterzahl
                            </label>
                            <input
                                type="number"
                                name="employee-count"
                                id="employee-count"
                                value={employeeCount}
                                onChange={e => setEmployeeCount(e.target.value)}
                                className="mt-1 block w-full pl-3 pr-10 py-3 text-base border-gray-300 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm rounded-md shadow-sm"
                                placeholder="z.B. 25"
                            />
                        </div>

                        <div className="flex flex-col sm:flex-row gap-4">
                            <button type="submit" disabled={!clientName.trim() || !revenue || !employeeCount} className="flex-1 w-full bg-emerald-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-emerald-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center shadow-lg">
                                Neue Analyse starten <ArrowRight className="ml-2 w-5 h-5" />
                            </button>
                             <button type="button" onClick={handleLoadClick} className="flex-1 w-full bg-gray-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-gray-700 flex items-center justify-center shadow-lg">
                                Analyse laden <Upload className="ml-2 w-5 h-5" />
                            </button>
                            <input type="file" ref={fileInputRef} onChange={handleFileChange} className="hidden" accept=".json" />
                        </div>
                    </form>
                </div>
            )
        }
        
        function IndustrySelection({ onSelect, onBack }) {
            const [selectedIndustry, setSelectedIndustry] = useState('');
            const handleSubmit = (e) => { e.preventDefault(); if (selectedIndustry) onSelect(selectedIndustry); };

            return (
                <div className="w-full max-w-2xl mx-auto">
                     <div className="relative text-center">
                        <button onClick={onBack} className="absolute -top-4 left-0 text-gray-500 hover:text-emerald-600 p-2 rounded-full hover:bg-gray-100">
                            <ArrowLeft className="w-6 h-6" />
                        </button>
                        <Briefcase className="w-16 h-16 mx-auto text-emerald-600 mb-4" />
                        <h2 className="text-3xl font-bold text-gray-800">Branchenauswahl</h2>
                        <p className="mt-2 text-lg text-gray-600">Bitte wählen Sie die passende Branche für die Analyse.</p>
                    </div>
                    <form onSubmit={handleSubmit} className="mt-10">
                        <select id="industry" value={selectedIndustry} onChange={(e) => setSelectedIndustry(e.target.value)} className="mt-1 block w-full pl-3 pr-10 py-3 text-base border-gray-300 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm rounded-md shadow-sm">
                            <option value="" disabled>Branche wählen...</option>
                            {Object.entries(ebitdaMultiples).map(([key, value]) => (<option key={key} value={key}>{value.name}</option>))}
                        </select>
                        <button type="submit" disabled={!selectedIndustry} className="mt-6 w-full bg-emerald-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-emerald-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center shadow-lg">
                            Weiter zur Unterkategorie <ArrowRight className="ml-2 w-5 h-5" />
                        </button>
                    </form>
                </div>
            );
        }

        function SubCategorySelection({ industry, onSelect, onBack }) {
            const [selectedSubCategory, setSelectedSubCategory] = useState('');
            const { name, subCategories } = ebitdaMultiples[industry];

            const handleSubmit = (e) => {
                e.preventDefault();
                if (selectedSubCategory) {
                    onSelect(selectedSubCategory);
                }
            };

            return (
                <div className="w-full max-w-2xl mx-auto">
                    <div className="relative text-center">
                        <button onClick={onBack} className="absolute -top-4 left-0 text-gray-500 hover:text-emerald-600 p-2 rounded-full hover:bg-gray-100">
                            <ArrowLeft className="w-6 h-6" />
                        </button>
                        <Building2 className="w-16 h-16 mx-auto text-emerald-600 mb-4" />
                        <h2 className="text-3xl font-bold text-gray-800">Spezialisierung für "{name}"</h2>
                        <p className="mt-2 text-lg text-gray-600">Bitte wählen Sie die passende Unterkategorie.</p>
                    </div>
                    <form onSubmit={handleSubmit} className="mt-10">
                        <select id="sub-category" value={selectedSubCategory} onChange={(e) => setSelectedSubCategory(e.target.value)} className="mt-1 block w-full pl-3 pr-10 py-3 text-base border-gray-300 focus:outline-none focus:ring-emerald-500 focus:border-emerald-500 sm:text-sm rounded-md shadow-sm">
                            <option value="" disabled>Unterkategorie wählen...</option>
                            {Object.entries(subCategories).map(([key, value]) => (<option key={key} value={key}>{value.name}</option>))}
                        </select>
                        <button type="submit" disabled={!selectedSubCategory} className="mt-6 w-full bg-emerald-600 text-white font-bold py-3 px-4 rounded-lg hover:bg-emerald-700 disabled:bg-gray-400 disabled:cursor-not-allowed flex items-center justify-center shadow-lg">
                            Analyse starten <ArrowRight className="ml-2 w-5 h-5" />
                        </button>
                    </form>
                </div>
            );
        }

        function Questionnaire({ questions, industry, industryName, onSubmit, onBack }) {
            const [currentQuestionIndex, setCurrentQuestionIndex] = useState(0);
            const [answers, setAnswers] = useState({});
            const [helpContent, setHelpContent] = useState(null);
            const [benchmarkContent, setBenchmarkContent] = useState(null);

            const currentQuestion = questions[currentQuestionIndex];
            const progress = ((currentQuestionIndex + 1) / questions.length) * 100;

            const handleAnswer = (questionId, value) => {
                const newAnswers = { ...answers, [questionId]: value };
                setAnswers(newAnswers);
                setTimeout(() => {
                    if (currentQuestionIndex < questions.length - 1) setCurrentQuestionIndex(currentQuestionIndex + 1);
                    else onSubmit(newAnswers);
                }, 400);
            };

            const handleBack = () => {
                if (currentQuestionIndex > 0) {
                    setCurrentQuestionIndex(currentQuestionIndex - 1);
                } else {
                    onBack();
                }
            };

            const showHelp = (question) => {
                setHelpContent(question.help);
                const benchmarkKey = question.benchmarkKey;
                if (benchmarkKey && staticBenchmarkKPIs[industry] && staticBenchmarkKPIs[industry][benchmarkKey]) {
                    setBenchmarkContent(staticBenchmarkKPIs[industry][benchmarkKey]);
                } else {
                    setBenchmarkContent(null);
                }
            };

            const closeHelp = () => {
                setHelpContent(null);
                setBenchmarkContent(null);
            };

            return (
                <div className="w-full max-w-3xl mx-auto">
                    {helpContent && <HelpPanel content={helpContent} benchmark={benchmarkContent} onClose={closeHelp} />}
                    <div className="mb-6">
                        <div className="flex justify-between mb-1">
                            <span className="text-sm font-medium text-gray-500">Frage {currentQuestionIndex + 1} von {questions.length}</span>
                            <span className="text-sm font-medium text-emerald-700">{Math.round(progress)}%</span>
                        </div>
                        <div className="w-full bg-gray-200 rounded-full h-2.5"><div className="bg-emerald-600 h-2.5 rounded-full" style={{ width: `${progress}%` }}></div></div>
                    </div>
                    <div className="bg-white p-8 rounded-xl shadow-lg border border-gray-100 relative">
                         <button onClick={handleBack} className="absolute top-4 right-4 text-gray-500 hover:text-emerald-600 p-2 rounded-full hover:bg-gray-100">
                             <ArrowLeft className="w-6 h-6" />
                         </button>
                        <div className="flex items-center mb-4">{categoryIcons[currentQuestion.category]}<span className="text-sm font-semibold uppercase tracking-wider text-gray-500">Kategorie: {riskMatrix[currentQuestion.category].label}</span></div>
                        <div className="flex justify-between items-start">
                            <p className="text-xl font-semibold text-gray-800 mb-6 flex-grow pr-12">{currentQuestion.text}</p>
                            {currentQuestion.help && (
                                <button onClick={() => showHelp(currentQuestion)} className="absolute top-4 right-16 text-gray-400 hover:text-emerald-600 flex-shrink-0">
                                    <Info className="w-6 h-6" />
                                </button>
                            )}
                        </div>
                        <div className="space-y-3">
                            {currentQuestion.options.map((option, index) => (
                                <button key={index} onClick={() => handleAnswer(currentQuestion.id, option.value)} className={`w-full text-left p-4 border rounded-lg transition-all duration-200 ease-in-out transform hover:scale-105 hover:shadow-md flex items-center ${answers[currentQuestion.id] === option.value ? 'bg-emerald-500 border-emerald-500 text-white font-bold' : 'bg-gray-50 hover:bg-emerald-100 border-gray-200 text-gray-700'}`}>
                                    <CheckCircle className={`w-5 h-5 mr-3 transition-opacity ${answers[currentQuestion.id] === option.value ? 'opacity-100' : 'opacity-0'}`} />{option.text}
                                </button>
                            ))}
                        </div>
                    </div>
                </div>
            );
        }
        
        function GeminiModal({ title, content, onClose, isLoading }) {
            const renderContent = (text) => {
                if (!text) return '';
                // Simple markdown to HTML conversion for bold and lists
                let html = text
                    .replace(/###TITEL###|###BESCHREIBUNG###|\|\|\|/g, '') // Clean up custom markers
                    .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                    .replace(/\n\s*\*\s/g, '</li><li>')
                    .replace(/\n/g, '<br />');

                if (html.includes('<li>')) {
                    html = '<ul><li>' + html.substring(html.indexOf('<li>') + 4) + '</li></ul>';
                    html = html.replace('<ul><br />', '<ul>');
                }
                return html;
            };

            return (
                <div className="fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-4">
                    <div className="bg-white rounded-lg shadow-2xl w-full max-w-2xl max-h-[90vh] flex flex-col">
                        <header className="flex justify-between items-center p-4 border-b">
                            <h3 className="text-lg font-bold text-gray-800 flex items-center"><Sparkles className="w-5 h-5 mr-2 text-emerald-500" /> {title}</h3>
                            <button onClick={onClose} className="text-gray-400 hover:text-gray-600"><X className="w-6 h-6" /></button>
                        </header>
                        <main className="p-6 overflow-y-auto">
                            {isLoading ? (
                                <div className="text-center">
                                    <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600 mx-auto mb-4"></div>
                                    <p className="text-gray-600">Analyse wird erstellt...</p>
                                </div>
                            ) : (
                                <div className="prose max-w-none" dangerouslySetInnerHTML={{ __html: renderContent(content) }}></div>
                            )}
                        </main>
                    </div>
                </div>
            );
        }

        const BenchmarkChart = ({ userValue, benchmarkValue }) => {
            const maxValue = 100;
            const userPercentage = (userValue / maxValue) * 100;
            const benchmarkPercentage = benchmarkValue !== null ? (benchmarkValue / maxValue) * 100 : 0;

            const getBarColor = (value) => {
                const riskValue = value / 100;
                if (riskValue <= 0.25) return 'bg-green-500';
                if (riskValue <= 0.50) return 'bg-yellow-500';
                return 'bg-red-500';
            };

            return (
                <div className="w-full mt-2">
                    <div className="mb-2">
                        <div className="flex justify-between mb-1">
                            <span className="text-xs font-medium text-gray-700">Ihr Risiko</span>
                            <span className="text-xs font-medium text-gray-700">{userValue.toFixed(0)}%</span>
                        </div>
                        <div className="w-full bg-gray-200 rounded-full h-2.5">
                            <div className={`${getBarColor(userValue)} h-2.5 rounded-full`} style={{ width: `${userPercentage}%` }}></div>
                        </div>
                    </div>
                    <div>
                        <div className="flex justify-between mb-1">
                            <span className="text-xs font-medium text-emerald-700">Branchenschnitt</span>
                            <span className="text-xs font-medium text-emerald-700">{benchmarkValue !== null ? `${benchmarkValue.toFixed(0)}%` : 'N/A'}</span>
                        </div>
                        <div className="w-full bg-gray-200 rounded-full h-2.5">
                            <div className="bg-emerald-500 h-2.5 rounded-full" style={{ width: `${benchmarkPercentage}%` }}></div>
                        </div>
                    </div>
                </div>
            );
        };

        function RadarChart({ userScores, benchmarkScores }) {
            const chartRef = useRef(null);
            const chartInstance = useRef(null);

            useEffect(() => {
                 if (chartRef.current) {
                    if (chartInstance.current) {
                        chartInstance.current.destroy();
                    }
                    const myChartRef = chartRef.current.getContext('2d');
                    
                    chartInstance.current = new Chart(myChartRef, {
                        type: 'radar',
                        data: {
                            labels: Object.keys(userScores),
                            datasets: [
                                {
                                    label: 'Ihr Risiko',
                                    data: Object.values(userScores),
                                    backgroundColor: 'rgba(239, 68, 68, 0.2)',
                                    borderColor: 'rgba(239, 68, 68, 1)',
                                    borderWidth: 2,
                                },
                                 {
                                    label: 'Branchenschnitt',
                                    data: Object.values(benchmarkScores),
                                    backgroundColor: 'rgba(16, 185, 129, 0.2)',
                                    borderColor: 'rgba(16, 185, 129, 1)',
                                    borderWidth: 1,
                                }
                            ]
                        },
                        options: {
                           scales: {
                                r: {
                                    angleLines: {
                                        display: false
                                    },
                                    suggestedMin: 0,
                                    suggestedMax: 1,
                                     pointLabels: {
                                         font: {
                                             size: 11
                                         }
                                     }
                                }
                            },
                            plugins: {
                                legend: {
                                    position: 'top',
                                },
                            },
                            maintainAspectRatio: false,
                        }
                    });
                 }
                return () => {
                    if (chartInstance.current) {
                        chartInstance.current.destroy();
                    }
                }
            }, [userScores, benchmarkScores]);

            return <canvas ref={chartRef} id="radar-chart-canvas" />;
        }
        
        function Bewertungsrechner({ industry, subCategory, totalDiscount, getRiskColor, calculatorState, onCalculatorChange, standardMultiples }) {
             const { ebitda, useCustomMultiple, customMultiples } = calculatorState;
            
            const currentMultiples = useCustomMultiple ? customMultiples : standardMultiples;

            const handleCustomMultipleChange = (field, value) => {
                const numValue = parseFloat(value);
                if (!isNaN(numValue)) {
                    onCalculatorChange({ ...calculatorState, customMultiples: {...customMultiples, [field]: numValue }});
                }
            };

             const handleEbitdaChange = (e) => {
                onCalculatorChange({ ...calculatorState, ebitda: Number(e.target.value) || 0 });
            };

            const handleToggleChange = () => {
                onCalculatorChange({ ...calculatorState, useCustomMultiple: !useCustomMultiple });
            };

            
            const formatCurrency = (value) => new Intl.NumberFormat('de-DE', { style: 'currency', currency: 'EUR', minimumFractionDigits: 0, maximumFractionDigits: 0 }).format(value);

            const adjustedMinMultiple = currentMultiples.min * (1 - totalDiscount);
            const adjustedMaxMultiple = currentMultiples.max * (1 - totalDiscount);

            const baseValueMin = currentMultiples.min * ebitda;
            const baseValueMax = currentMultiples.max * ebitda;

            const adjustedValueMin = baseValueMin * (1 - totalDiscount);
            const adjustedValueMax = baseValueMax * (1 - totalDiscount);

            return (
                 <div className="bg-white p-6 rounded-xl shadow-lg border border-gray-100 h-full flex flex-col space-y-4">
                    <h3 className="text-lg font-semibold text-gray-800 flex items-center"><DollarSign className="w-5 h-5 mr-2 text-gray-600" />Bewertungsrechner</h3>
                    
                    <div>
                      <label htmlFor="ebitda" className="block text-sm font-medium text-gray-700">EBITDA (nachhaltig)</label>
                      <div className="mt-1 relative rounded-md shadow-sm">
                        <div className="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                          <span className="text-gray-500 sm:text-lg">€</span>
                        </div>
                        <input
                          type="number"
                          name="ebitda"
                          id="ebitda"
                          className="focus:ring-emerald-500 focus:border-emerald-500 block w-full pl-7 pr-12 sm:text-lg text-xl border-gray-300 rounded-md"
                          value={ebitda}
                          onChange={handleEbitdaChange}
                          placeholder="1.000.000"
                        />
                      </div>
                    </div>

                    <div className="flex items-center justify-between">
                        <span className="text-sm font-medium text-gray-700">Multiple-Basis</span>
                        <div className="flex items-center">
                            <span className={`text-sm mr-2 ${!useCustomMultiple ? 'font-bold text-emerald-600' : 'text-gray-500'}`}>Standard (Größenadjustiert)</span>
                            <label htmlFor="multiple-toggle" className="inline-flex relative items-center cursor-pointer">
                                <input type="checkbox" id="multiple-toggle" className="sr-only peer" checked={useCustomMultiple} onChange={handleToggleChange} />
                                <div className="w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-4 peer-focus:ring-emerald-300 peer-checked:bg-emerald-600 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all"></div>
                            </label>
                            <span className={`text-sm ml-2 ${useCustomMultiple ? 'font-bold text-emerald-600' : 'text-gray-500'}`}>Individuell</span>
                        </div>
                    </div>

                    {useCustomMultiple && (
                        <div className="grid grid-cols-2 gap-4">
                             <div>
                                <label htmlFor="min-multiple" className="block text-xs font-medium text-gray-500">Min. Multiple</label>
                                <input type="number" name="min-multiple" id="min-multiple" step="0.1" value={customMultiples.min} onChange={e => handleCustomMultipleChange('min', e.target.value)} className="mt-1 focus:ring-emerald-500 focus:border-emerald-500 block w-full sm:text-sm border-gray-300 rounded-md" />
                            </div>
                            <div>
                                <label htmlFor="max-multiple" className="block text-xs font-medium text-gray-500">Max. Multiple</label>
                                <input type="number" name="max-multiple" id="max-multiple" step="0.1" value={customMultiples.max} onChange={e => handleCustomMultipleChange('max', e.target.value)} className="mt-1 focus:ring-emerald-500 focus:border-emerald-500 block w-full sm:text-sm border-gray-300 rounded-md" />
                            </div>
                        </div>
                    )}
                     
                    <div className="border-t border-gray-200 pt-4 mt-4 space-y-2">
                        <div className="text-center">
                            <p className="text-sm text-gray-500">Risikoadjustierter Multiple</p>
                            <p className={`text-xl font-bold ${getRiskColor(totalDiscount)}`}>{adjustedMinMultiple.toFixed(1)}x - {adjustedMaxMultiple.toFixed(1)}x</p>
                        </div>
                        <div className="text-center">
                           <p className="text-sm text-gray-500">Resultierende Bewertungsspanne</p>
                           <p className="text-2xl font-bold text-gray-800">{formatCurrency(adjustedValueMin)} - {formatCurrency(adjustedValueMax)}</p>
                        </div>
                        <div className="text-center pt-2 border-t border-gray-100 mt-2">
                            <p className="text-xs text-gray-400">Größenadjustierte Spanne (ohne Risikoabschlag): {standardMultiples.min.toFixed(1)}x - {standardMultiples.max.toFixed(1)}x</p>
                            <p className="text-xs text-gray-400">({formatCurrency(baseValueMin)} - {formatCurrency(baseValueMax)})</p>
                        </div>
                    </div>
                 </div>
            );
        }
        
        function DiscountDerivationTable({ results, onWeightingChange, getRiskColor }) {
            const { detailedBreakdown, totalDiscount } = results;
            
            const handleWeightChange = (category, delta) => {
                const currentWeight = detailedBreakdown.find(item => item.category === category).weighting;
                const newWeight = Math.max(0, Math.min(1, currentWeight + delta));
                onWeightingChange(category, newWeight);
            };

            const getRiskTextColorByPercentage = (percentage) => {
                if (percentage <= 0.25) return 'text-yellow-600 font-semibold';
                if (percentage <= 0.50) return 'text-orange-500 font-semibold';
                return 'text-red-600 font-semibold';
            };

            return (
                 <div className="bg-white p-6 rounded-xl shadow-lg border border-gray-100">
                    <h3 className="text-2xl font-bold text-gray-800 text-center mb-6">Detaillierte Herleitung des Abschlags</h3>
                    <div className="overflow-x-auto">
                        <table className="w-full text-left min-w-[600px]">
                            <thead>
                                <tr className="border-b border-gray-200">
                                    <th className="p-3 text-sm font-semibold uppercase text-gray-500 tracking-wider">Parameter</th>
                                    <th className="p-3 text-sm font-semibold uppercase text-gray-500 tracking-wider text-right">Risikozuschlag</th>
                                    <th className="p-3 text-sm font-semibold uppercase text-gray-500 tracking-wider text-center">Gewichtung</th>
                                    <th className="p-3 text-sm font-semibold uppercase text-gray-500 tracking-wider text-right">Abschlag</th>
                                </tr>
                            </thead>
                            <tbody>
                                {detailedBreakdown.map((item) => (
                                    <tr key={item.category} className="border-b border-gray-100 last:border-b-0">
                                        <td className="p-3 font-medium text-gray-800">{item.label}</td>
                                        <td className={`p-3 text-right ${getRiskTextColorByPercentage(item.riskPercentage)}`}>{(item.riskPercentage * 100).toFixed(0)}%</td>
                                        <td className="p-3 text-center">
                                            <div className="flex items-center justify-center space-x-2">
                                                 <button onClick={() => handleWeightChange(item.category, -0.01)} className="text-gray-500 hover:text-red-600 p-1 rounded-full bg-gray-100 hover:bg-red-100"><ChevronDown className="w-4 h-4" /></button>
                                                 <span className="font-semibold w-12">{(item.weighting * 100).toFixed(0)}%</span>
                                                 <button onClick={() => handleWeightChange(item.category, 0.01)} className="text-gray-500 hover:text-green-600 p-1 rounded-full bg-gray-100 hover:bg-green-100"><ChevronUp className="w-4 h-4" /></button>
                                            </div>
                                        </td>
                                        <td className="p-3 text-right font-bold text-gray-800">{(item.discount * 100).toFixed(1)}%</td>
                                    </tr>
                                ))}
                            </tbody>
                            <tfoot className="border-t-2 border-gray-200">
                                <tr>
                                    <td colSpan="2" className="p-3 font-semibold text-gray-600 text-right">Summe Gewichtung</td>
                                    <td className="p-3 text-center font-bold text-gray-800">
                                        {(detailedBreakdown.reduce((sum, item) => sum + item.weighting, 0) * 100).toFixed(0)}%
                                    </td>
                                    <td className="p-3"></td>
                                </tr>
                                <tr className="bg-gray-50">
                                    <td className="p-4 text-lg font-bold text-gray-900 rounded-bl-xl" colSpan="3">Gesamtausprägung</td>
                                    <td className={`p-4 text-right text-lg font-bold rounded-br-xl ${getRiskColor(totalDiscount)}`}>{(totalDiscount * 100).toFixed(1)}%</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            );
        }
        
       function PeerGroupTable({ peerGroup, isLoading, error }) {
            const getFlagEmoji = (countryCode) => {
                if (!countryCode || countryCode.length !== 2) return '';
                const codePoints = countryCode
                    .toUpperCase()
                    .split('')
                    .map(char => 127397 + char.charCodeAt());
                return String.fromCodePoint(...codePoints);
            };

            const calculateStats = (key) => {
                if (!peerGroup || peerGroup.length === 0) return { min: 'N/A', max: 'N/A', median: 'N/A', mean: 'N/A' };
        
                const values = peerGroup
                    .map(c => parseFloat(c[key]?.replace('x', '').replace('%', '')))
                    .filter(v => !isNaN(v));
        
                if (values.length === 0) return { min: 'N/A', max: 'N/A', median: 'N/A', mean: 'N/A' };
        
                values.sort((a, b) => a - b);
        
                const min = Math.min(...values);
                const max = Math.max(...values);
                const mean = values.reduce((a, b) => a + b, 0) / values.length;
        
                let median;
                const mid = Math.floor(values.length / 2);
                if (values.length % 2 === 0) {
                    median = (values[mid - 1] + values[mid]) / 2;
                } else {
                    median = values[mid];
                }

                const suffix = key.includes('margin') ? '%' : 'x';

                return {
                    min: `${min.toFixed(1)}${suffix}`,
                    max: `${max.toFixed(1)}${suffix}`,
                    median: `${median.toFixed(1)}${suffix}`,
                    mean: `${mean.toFixed(1)}${suffix}`,
                };
            };
            
            const stats = {
                ev_ebitda_ltm: calculateStats('ev_ebitda_ltm'),
                ev_ebitda_current: calculateStats('ev_ebitda_current'),
                ev_sales: calculateStats('ev_sales'),
                pe_ratio: calculateStats('pe_ratio'),
                ebitda_margin: calculateStats('ebitda_margin'),
            };

            if (isLoading) {
                return (
                    <div className="mt-12 bg-white p-6 rounded-xl shadow-lg border border-gray-100 text-center">
                        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600 mx-auto mb-4"></div>
                        <p className="text-gray-600">Peergroup wird erstellt...</p>
                    </div>
                );
            }

            if (error) {
                return (
                    <div className="mt-12 bg-red-50 p-6 rounded-xl border border-red-200 text-center">
                        <p className="text-red-700 font-semibold">Fehler beim Laden der Peergroup</p>
                        <p className="text-red-600 text-sm mt-2">{error}</p>
                    </div>
                );
            }

            if (!peerGroup) return null;

            return (
                <div className="mt-12 bg-white p-6 rounded-xl shadow-lg border border-gray-100">
                    <h3 className="text-2xl font-bold text-gray-800 text-center mb-6">Börsennotierte Peergroup</h3>
                    <div className="overflow-x-auto">
                        <table className="w-full text-left">
                            <thead className="bg-gray-50">
                                <tr>
                                    <th className="p-3 text-sm font-semibold uppercase text-gray-500 tracking-wider">Unternehmen</th>
                                    <th className="p-3 text-sm font-semibold uppercase text-gray-500 tracking-wider">Schwerpunkt</th>
                                    <th className="p-3 text-sm font-semibold uppercase text-gray-500 tracking-wider text-center">EV/EBITDA (LTM)</th>
                                    <th className="p-3 text-sm font-semibold uppercase text-gray-500 tracking-wider text-center">EV/EBITDA (Aktuell)</th>
                                    <th className="p-3 text-sm font-semibold uppercase text-gray-500 tracking-wider text-center">EV/Sales</th>
                                    <th className="p-3 text-sm font-semibold uppercase text-gray-500 tracking-wider text-center">P/E Ratio</th>
                                    <th className="p-3 text-sm font-semibold uppercase text-gray-500 tracking-wider text-center">EBITDA-Marge</th>
                                </tr>
                            </thead>
                            <tbody>
                                {peerGroup.map((company, index) => (
                                    <tr key={index} className="border-b border-gray-100 last:border-b-0">
                                        <td className="p-3 font-medium text-gray-800">
                                            <a href={company.website_url} target="_blank" rel="noopener noreferrer" className="inline-flex items-center text-emerald-600 hover:underline">
                                                <span className="mr-2">{getFlagEmoji(company.nationality)}</span>
                                                {company.name}
                                            </a>
                                        </td>
                                         <td className="p-3 text-sm text-gray-600">{company.business_focus}</td>
                                        <td className="p-3 text-center text-gray-600">{company.ev_ebitda_ltm}</td>
                                        <td className="p-3 text-center text-gray-600">{company.ev_ebitda_current}</td>
                                        <td className="p-3 text-center text-gray-600">{company.ev_sales}</td>
                                        <td className="p-3 text-center text-gray-600">{company.pe_ratio}</td>
                                        <td className="p-3 text-center text-gray-600">{company.ebitda_margin}</td>
                                    </tr>
                                ))}
                            </tbody>
                             <tfoot className="bg-gray-100 font-semibold">
                                <tr>
                                    <td colSpan="2" className="p-3 text-sm text-gray-700">Minimum</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.ev_ebitda_ltm.min}</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.ev_ebitda_current.min}</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.ev_sales.min}</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.pe_ratio.min}</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.ebitda_margin.min}</td>
                                </tr>
                                 <tr>
                                    <td colSpan="2" className="p-3 text-sm text-gray-700">Maximum</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.ev_ebitda_ltm.max}</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.ev_ebitda_current.max}</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.ev_sales.max}</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.pe_ratio.max}</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.ebitda_margin.max}</td>
                                </tr>
                                <tr>
                                    <td colSpan="2" className="p-3 text-sm text-gray-700">Median (50. Perzentil)</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.ev_ebitda_ltm.median}</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.ev_ebitda_current.median}</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.ev_sales.median}</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.pe_ratio.median}</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.ebitda_margin.median}</td>
                                </tr>
                                <tr className="border-t-2 border-gray-300">
                                    <td colSpan="2" className="p-3 text-sm text-gray-700">Arithmetisches Mittel</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.ev_ebitda_ltm.mean}</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.ev_ebitda_current.mean}</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.ev_sales.mean}</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.pe_ratio.mean}</td>
                                    <td className="p-3 text-center text-sm text-gray-700">{stats.ebitda_margin.mean}</td>
                                </tr>
                            </tfoot>
                        </table>
                    </div>
                </div>
            );
        }

        function MarketDevelopment({ data, isLoading, error }) {
            const renderTextWithLineBreaks = (text) => {
                if (!text) return null;
                return text.split('\n').map((line, index) => (
                    <React.Fragment key={index}>
                        {line}
                        <br />
                    </React.Fragment>
                ));
            };

            const renderBulletPoints = (text) => {
                if (!text) return null;
                const items = text.split('* ').filter(item => item.trim() !== '');
                return (
                    <ul className="list-disc pl-5 space-y-1">
                        {items.map((item, index) => <li key={index}>{item.trim()}</li>)}
                    </ul>
                );
            };
        
            if (isLoading) {
                return (
                    <div className="mt-12 bg-white p-6 rounded-xl shadow-lg border border-gray-100 text-center">
                        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600 mx-auto mb-4"></div>
                        <p className="text-gray-600">Marktentwicklung wird analysiert...</p>
                    </div>
                );
            }
        
            if (error) {
                return (
                    <div className="mt-12 bg-red-50 p-6 rounded-xl border border-red-200 text-center">
                        <p className="text-red-700 font-semibold">Fehler bei der Analyse der Marktentwicklung</p>
                        <p className="text-red-600 text-sm mt-2">{error}</p>
                    </div>
                );
            }
            
            if (!data) return null;
        
            return (
                <div className="mt-12 bg-white p-8 rounded-xl shadow-lg border border-gray-100 space-y-10">
                    <header className="text-center">
                        <h2 className="text-3xl font-bold text-gray-800">Branchendarstellung: {data.title}</h2>
                    </header>
        
                    {data.multiples_entwicklung && (
                        <section>
                            <h3 className="text-xl font-bold text-gray-800 mb-4">Entwicklung der Bewertungs-Multiples</h3>
                             <div className="overflow-x-auto">
                                <table className="w-full text-left">
                                    <thead className="bg-gray-50">
                                        <tr>
                                            <th className="p-3 text-sm font-semibold uppercase text-gray-500 tracking-wider">Jahr</th>
                                            <th className="p-3 text-sm font-semibold uppercase text-gray-500 tracking-wider text-center">EV/EBITDA Multiple</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-gray-200">
                                        {data.multiples_entwicklung.map((item, index) => (
                                            <tr key={index}>
                                                <td className="p-3 font-medium text-gray-600">{item.year}</td>
                                                <td className="p-3 text-center text-lg font-semibold text-gray-800">{item.multiple}</td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        </section>
                    )}
        
                    {data.marktueberblick && (
                        <section className="p-4 bg-blue-50 border-l-4 border-blue-400 rounded-r-lg">
                            <h3 className="text-xl font-bold text-blue-800 mb-3">1. Marktüberblick</h3>
                            <div className="prose prose-sm max-w-none text-gray-700 space-y-2">
                               {renderTextWithLineBreaks(data.marktueberblick)}
                            </div>
                        </section>
                    )}
        
                    {data.schluesseltrends && (
                        <section className="p-4 bg-gray-50 border-l-4 border-gray-400 rounded-r-lg">
                            <h3 className="text-xl font-bold text-gray-800 mb-3">2. Schlüsseltrends & Treiber</h3>
                            <div className="prose prose-sm max-w-none text-gray-700 space-y-2">
                               {renderBulletPoints(data.schluesseltrends)}
                            </div>
                        </section>
                    )}
        
                    {data.wettbewerbslandschaft && (
                         <section className="p-4 bg-blue-50 border-l-4 border-blue-400 rounded-r-lg">
                            <h3 className="text-xl font-bold text-blue-800 mb-3">3. Wettbewerbslandschaft</h3>
                            <div className="prose prose-sm max-w-none text-gray-700 space-y-2">
                               {renderTextWithLineBreaks(data.wettbewerbslandschaft)}
                            </div>
                             {data.top_10_players && data.top_10_players.length > 0 && (
                                <div className="mt-4">
                                    <h4 className="font-semibold text-blue-700 mb-2">Top Player nach Marktanteil (geschätzt)</h4>
                                    <div className="overflow-x-auto">
                                        <table className="w-full text-left text-sm">
                                            <thead className="bg-blue-100">
                                                <tr>
                                                    <th className="p-2 font-semibold">Unternehmen</th>
                                                    <th className="p-2 font-semibold text-right">Marktanteil</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                {data.top_10_players.map((player, index) => (
                                                    <tr key={index} className="border-b border-blue-200 last:border-0">
                                                        <td className="p-2">{player.name}</td>
                                                        <td className="p-2 text-right font-medium">{player.market_share}</td>
                                                    </tr>
                                                ))}
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            )}
                        </section>
                    )}
        
                     <div className="grid grid-cols-1 md:grid-cols-2 gap-8">
                        {data.chancen && (
                            <section className="p-4 bg-green-50 border-l-4 border-green-500 rounded-r-lg">
                                <h3 className="text-xl font-bold text-green-800 mb-3">4. Chancen</h3>
                                <div className="prose prose-sm max-w-none text-green-900">
                                    {renderBulletPoints(data.chancen)}
                                </div>
                            </section>
                        )}
            
                        {data.risiken && (
                            <section className="p-4 bg-red-50 border-l-4 border-red-500 rounded-r-lg">
                                <h3 className="text-xl font-bold text-red-800 mb-3">4. Risiken</h3>
                                <div className="prose prose-sm max-w-none text-red-900">
                                    {renderBulletPoints(data.risiken)}
                                </div>
                            </section>
                        )}
                    </div>
        
                    {data.ausblick_empfehlungen && (
                        <section className="p-4 bg-gray-100 rounded-lg">
                            <h3 className="text-xl font-bold text-gray-800 mb-3">5. Ausblick & Empfehlungen</h3>
                            <div className="prose prose-sm max-w-none text-gray-700 space-y-2">
                                {renderTextWithLineBreaks(data.ausblick_empfehlungen)}
                            </div>
                        </section>
                    )}
                </div>
            );
        }
        
        function ActionPlansSection({ actionPlans, isLoading, error }) {
            const renderBulletPoints = (text) => {
                if (!text) return null;
                const items = text.split('* ').filter(item => item.trim() !== '');
                return (
                    <ul className="list-disc pl-5 space-y-2 text-sm">
                        {items.map((item, index) => <li key={index} dangerouslySetInnerHTML={{ __html: item.trim().replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>') }} />)}
                    </ul>
                );
            };

            const getCategoryColor = (category) => {
                 const colors = {
                    'Organisation': 'blue',
                    'Personal': 'orange',
                    'Markt': 'sky',
                    'Finanzen': 'gray',
                    'IT': 'violet',
                    'Recht': 'rose',
                };
                return colors[category] || 'gray';
            }

            if (isLoading) {
                return (
                    <div className="mt-12 bg-white p-6 rounded-xl shadow-lg border border-gray-100 text-center">
                        <div className="animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600 mx-auto mb-4"></div>
                        <p className="text-gray-600">Maßnahmenpläne werden erstellt...</p>
                    </div>
                );
            }

            if (error) {
                return (
                    <div className="mt-12 bg-red-50 p-6 rounded-xl border border-red-200 text-center">
                        <p className="text-red-700 font-semibold">Fehler beim Erstellen der Maßnahmenpläne</p>
                        <p className="text-red-600 text-sm mt-2">{error}</p>
                    </div>
                );
            }

            if (!actionPlans) return null;

            return (
                 <div className="mt-12 bg-white p-8 rounded-xl shadow-lg border border-gray-100 space-y-10">
                    <header className="text-center">
                        <h2 className="text-3xl font-bold text-gray-800">Management Summary & Handlungsempfehlungen</h2>
                    </header>

                     {actionPlans.summary && (
                        <section className="p-4 bg-gray-50 border-l-4 border-gray-400 rounded-r-lg">
                            <h3 className="text-xl font-bold text-gray-800 mb-3">Zusammenfassung</h3>
                            <div className="prose prose-sm max-w-none text-gray-700" dangerouslySetInnerHTML={{__html: actionPlans.summary.replace(/\n/g, '<br />')}}></div>
                        </section>
                    )}

                    {actionPlans.plans && Object.entries(actionPlans.plans).map(([category, plan]) => {
                        const color = getCategoryColor(category);
                        return (
                             <section key={category} className={`p-4 bg-${color}-50 border-l-4 border-${color}-400 rounded-r-lg`}>
                                <h3 className={`text-xl font-bold text-${color}-800 mb-3 flex items-center`}>{categoryIcons[category]} {plan.title}</h3>
                                <div className="prose prose-sm max-w-none text-gray-700 space-y-2">
                                   <p>{plan.intro}</p>
                                   <ul className="list-disc pl-5 space-y-1">
                                    {plan.recommendations.map((rec, index) => (
                                        <li key={index} dangerouslySetInnerHTML={{ __html: rec.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>') }} />
                                    ))}
                                   </ul>
                                </div>
                            </section>
                        )
                    })}
                </div>
            );
        }

        const ContactPerson = () => (
            <div className="mt-12 p-6 bg-white rounded-xl shadow-lg border border-gray-100">
                <h3 className="text-xl font-bold text-gray-800 mb-4">Ihr Ratingberater</h3>
                <div className="flex flex-col sm:flex-row items-center">
                    <img className="h-24 w-24 rounded-full" src="https://placehold.co/100x100/E2E8F0/4A5568?text=MR" alt="Mario Rüdel" />
                    <div className="sm:ml-6 mt-4 sm:mt-0 text-center sm:text-left">
                        <p className="text-lg font-bold text-gray-900">Mario Rüdel</p>
                        <p className="text-sm text-gray-600">Head of FPM & Finance</p>
                        <div className="mt-3 flex flex-wrap justify-center sm:justify-start gap-x-4 gap-y-2">
                             <a href="mailto:m.ruedel@walterfries.de" className="inline-flex items-center text-sm text-gray-600 hover:text-emerald-600">
                                 <Mail className="w-4 h-4 mr-2" /> m.ruedel@walterfries.de
                             </a>
                             <a href="https://www.linkedin.com/in/mario-r%C3%BCdel-b94159138/" className="inline-flex items-center text-sm text-gray-600 hover:text-emerald-600">
                                 <Linkedin className="w-4 h-4 mr-2" /> LinkedIn
                             </a>
                        </div>
                         <div className="mt-2 text-sm text-gray-500">
                             <span>f: +49 (0) 60 21 . 35 42 0</span>
                             <span className="mx-2">|</span>
                             <span>m: +49 (0) 157 . 73 35 42 16</span>
                         </div>
                    </div>
                </div>
            </div>
        );
        
        function App() {
            const [isUnlocked, setIsUnlocked] = useState(false);
            const [countdownEnded, setCountdownEnded] = useState(false);
            const [step, setStep] = useState('clientInfo');
            const [clientInfo, setClientInfo] = useState({ name: '', revenue: '', employeeCount: '' });
            const [industry, setIndustry] = useState(null);
            const [subCategory, setSubCategory] = useState(null);
            const [results, setResults] = useState(null);

            const getRiskColor = (value) => {
                if (value <= 0.15) return 'text-green-500';
                if (value <= 0.40) return 'text-yellow-500';
                return 'text-red-500';
            };
            
            const handleClientInfoSubmit = (info) => {
                setClientInfo(info);
                setStep('industrySelection');
            }

            const handleLoad = (data) => {
                setClientInfo(data.clientInfo);
                setIndustry(data.industry);
                setSubCategory(data.subCategory);
                setResults(data.results);
                setStep('dashboard');
            }

            const handleIndustrySelect = (selectedIndustry) => {
                setIndustry(selectedIndustry);
                setStep('subCategorySelection');
            };

            const handleSubCategorySelect = (selectedSubCategory) => {
                setSubCategory(selectedSubCategory);
                setStep('questionnaire');
            };
            
            const handleQuestionnaireSubmit = (answers) => {
                const questions = questionsByIndustry[industry].questions;
                let scores = {};
                let counts = {};
                Object.keys(riskMatrix).forEach(cat => { scores[cat] = 0; counts[cat] = 0; });

                const allQuestions = questionsByIndustry[industry].questions;
                allQuestions.forEach(q => {
                    const answerValue = answers[q.id];
                    if (answerValue && scores.hasOwnProperty(q.category)) {
                        scores[q.category] += answerValue;
                        counts[q.category]++;
                    }
                });

                const scoresByCategory = {};
                Object.keys(scores).forEach(category => {
                    scoresByCategory[category] = counts[category] > 0 ? scores[category] / counts[category] : 3;
                });
                
                const detailedBreakdown = Object.entries(riskMatrix).map(([category, matrixItem]) => {
                    const score = scoresByCategory[category];
                    const roundedScore = Math.min(5, Math.max(1, Math.round(score)));
                    const riskPercentage = matrixItem.riskBands[roundedScore];
                    const discount = riskPercentage * matrixItem.weighting;
                    return { category, label: matrixItem.label, riskPercentage, weighting: matrixItem.weighting, discount };
                });

                const totalDiscount = detailedBreakdown.reduce((acc, item) => acc + item.discount, 0);
                
                setResults({ detailedBreakdown, totalDiscount, answers });
                setStep('dashboard');
            };

            const handleRestart = () => {
                setStep('clientInfo');
                setClientInfo({ name: '', revenue: '', employeeCount: '' });
                setIndustry(null);
                setSubCategory(null);
                setResults(null);
            };

            const renderMainApp = () => {
                 switch (step) {
                    case 'clientInfo':
                        return <ClientInfo onNext={handleClientInfoSubmit} onLoad={handleLoad} />;
                    case 'industrySelection':
                         return <IndustrySelection onSelect={handleIndustrySelect} onBack={handleRestart} />;
                    case 'subCategorySelection':
                        return <SubCategorySelection industry={industry} onSelect={handleSubCategorySelect} onBack={() => setStep('industrySelection')} />;
                    case 'questionnaire':
                        return <Questionnaire questions={questionsByIndustry[industry].questions} industry={industry} industryName={ebitdaMultiples[industry].name} onSubmit={handleQuestionnaireSubmit} onBack={() => setStep('subCategorySelection')} />;
                    case 'dashboard':
                        return <Dashboard results={results} setResults={setResults} clientInfo={clientInfo} industry={industry} subCategory={subCategory} industryName={ebitdaMultiples[industry].subCategories[subCategory].name} onRestart={handleRestart} getRiskColor={getRiskColor} questions={questionsByIndustry[industry].questions} />;
                    default:
                        return <ClientInfo onNext={handleClientInfoSubmit} onLoad={handleLoad} />;
                }
            }
            
            function Dashboard({ results, setResults, clientInfo, industry, subCategory, industryName, questions, onRestart, getRiskColor }) {
                const { detailedBreakdown, totalDiscount, answers } = results;
                const [actionPlans, setActionPlans] = useState(null);
                const [isActionPlanLoading, setIsActionPlanLoading] = useState(false);
                const [actionPlanError, setActionPlanError] = useState(null);

                const [peerGroup, setPeerGroup] = useState(null);
                const [isPeerGroupLoading, setIsPeerGroupLoading] = useState(false);
                const [peerGroupError, setPeerGroupError] = useState(null);
                const [marketDevelopment, setMarketDevelopment] = useState(null);
                const [isMarketDevLoading, setIsMarketDevLoading] = useState(false);
                const [marketDevError, setMarketDevError] = useState(null);
                
                const subCategoryData = ebitdaMultiples[industry]?.subCategories?.[subCategory];

                const standardMultiples = useMemo(() => {
                    return getAdjustedMultiples(industry, subCategory, clientInfo.revenue, clientInfo.employeeCount);
                }, [industry, subCategory, clientInfo]);

                if (!subCategoryData) {
                    return <div>Fehler: Unterkategorie nicht gefunden.</div>;
                }
    
                const [calculatorState, setCalculatorState] = useState({
                    ebitda: 1000000,
                    useCustomMultiple: false,
                    customMultiples: { min: standardMultiples.min, max: standardMultiples.max }
                });
                
                const benchmarkData = staticBenchmarkCategories[industry];
    
                const userScores = useMemo(() => {
                    const scores = {};
                    detailedBreakdown.forEach(item => {
                        scores[item.label] = item.riskPercentage;
                    });
                    return scores;
                }, [detailedBreakdown]);
    
                const questionsPerCategory = useMemo(() => {
                    const counts = {};
                    for (const q of questions) {
                        counts[q.category] = (counts[q.category] || 0) + 1;
                    }
                    return counts;
                }, [questions]);

                const groupedQuestions = useMemo(() => {
                    return questions.reduce((acc, question) => {
                        const category = question.category;
                        if (!acc[category]) {
                            acc[category] = [];
                        }
                        acc[category].push(question);
                        return acc;
                    }, {});
                }, [questions]);
                
                const handleWeightingChange = (changedCategory, newWeight) => {
                    const oldWeight = detailedBreakdown.find(item => item.category === changedCategory).weighting;
                    const weightDifference = newWeight - oldWeight;
                    
                    const otherItems = detailedBreakdown.filter(item => item.category !== changedCategory);
                    const totalOtherWeight = otherItems.reduce((sum, item) => sum + item.weighting, 0);
    
                    let updatedBreakdown = detailedBreakdown.map(item => {
                        if (item.category === changedCategory) {
                            return { ...item, weighting: newWeight };
                        }
                        if (totalOtherWeight > 0) {
                            const proportionalChange = item.weighting / totalOtherWeight * weightDifference;
                            return { ...item, weighting: item.weighting - proportionalChange };
                        }
                        return item;
                    });
    
                    const totalNewWeight = updatedBreakdown.reduce((sum, item) => sum + item.weighting, 0);
                    if (Math.abs(totalNewWeight - 1.0) > 0.001) {
                        const normalizationFactor = 1.0 / totalNewWeight;
                        updatedBreakdown = updatedBreakdown.map(item => ({...item, weighting: item.weighting * normalizationFactor}));
                    }
    
                    updatedBreakdown = updatedBreakdown.map(item => ({...item, discount: item.riskPercentage * item.weighting}));
                    const newTotalDiscount = updatedBreakdown.reduce((sum, item) => sum + item.discount, 0);
    
                    setResults({ ...results, detailedBreakdown: updatedBreakdown, totalDiscount: newTotalDiscount });
                };
    
                const handleGenerateReportContent = async () => {
                    setIsActionPlanLoading(true);
                    setActionPlanError(null);
                    setActionPlans(null);

                    const highRiskCategories = detailedBreakdown.filter(item => item.riskPercentage > (benchmarkData[item.category] || 0));
                    
                    if (highRiskCategories.length === 0) {
                         setActionPlans({
                            summary: "Hervorragend! In allen Bereichen liegen Sie besser als der Branchenschnitt. Es gibt keine unmittelbaren, kritischen Handlungsempfehlungen. Konzentrieren Sie sich darauf, diesen hohen Standard zu halten und weiter zu optimieren.",
                            plans: {}
                        });
                         setIsActionPlanLoading(false);
                        return;
                    }

                    const categoryPrompts = highRiskCategories.map(item => {
                        const categoryQuestions = questions.filter(q => q.category === item.category);
                        const categoryAnswers = categoryQuestions.map(q => {
                            const answerValue = answers[q.id];
                            const selectedOption = q.options.find(opt => opt.value === answerValue);
                            return `- Frage: "${q.text}", Antwort: "${selectedOption ? selectedOption.text : 'N/A'}"`;
                        }).join('\n');
                        
                        return `
                        "${item.category}": {
                          "title": "Maßnahmenplan für ${item.label}",
                          "intro": "Eine 1-2 Sätze lange, prägnante Zusammenfassung, warum dieser Bereich kritisch ist, basierend auf den Antworten.",
                          "recommendations": [
                            "**1. Maßnahme:** Eine konkrete, umsetzbare Handlungsempfehlung.",
                            "**2. Maßnahme:** Eine weitere konkrete Empfehlung.",
                            "**3. Maßnahme:** Eine dritte konkrete Empfehlung."
                          ]
                        }`;
                    }).join(',');

                    const fullPrompt = `WICHTIG: Antworte NUR mit einem validen JSON-Objekt. Keine Erklärungen, kein Text außerhalb des JSON.
                    
                    AUFGABE: Du bist ein erfahrener M&A-Berater. Erstelle einen Bericht für das Unternehmen "${clientInfo.name}" (Branche: "${industryName}").
                    Der Bericht besteht aus einer Management Summary und detaillierten Maßnahmenplänen für die identifizierten Risikobereiche.
                    
                    DATENGRUNDLAGE:
                    - Gesamtrisikoabschlag: ${(totalDiscount * 100).toFixed(1)}%
                    - Hauptrisikotreiber: ${highRiskCategories.map(item => item.label).join(', ')}
                    - Details zu den Risikobereichen (Antworten und Bewertungen liegen dir implizit vor)

                    FORMAT: Deine Antwort muss EXAKT ein JSON-Objekt mit folgender Struktur sein:
                    {
                      "summary": "Verfasse eine Management Summary (ca. 100 Wörter). Beginne mit dem Gesamtergebnis und dem Risikoabschlag. Benenne die 2-3 größten Handlungsfelder und betone die Notwendigkeit zur Umsetzung der Maßnahmen zur Wertsteigerung.",
                      "plans": {
                        ${categoryPrompts}
                      }
                    }
                    
                    REGELN:
                    - Antworte AUSSCHLIESSLICH mit dem JSON-Objekt.
                    - Alle Werte müssen Strings sein.
                    - Formuliere professionell, direkt und auf den Punkt.
                    - Verwende Markdown für Fettungen (**Text**).
                    
                    BEGINNE DEINE ANTWORT DIREKT MIT: {`;

                     try {
                        const reportData = await callGeminiAPI(fullPrompt, true);
                        if (reportData && reportData.summary && reportData.plans) {
                            setActionPlans(reportData);
                        } else {
                            throw new Error("Ungültige Datenstruktur von der API erhalten.");
                        }
                    } catch (e) {
                        console.error("Fehler beim Erstellen des Reports: ", e);
                        setActionPlanError(e.message);
                    } finally {
                        setIsActionPlanLoading(false);
                    }
                };

                 const handleSave = () => {
                    const dataToSave = {
                        clientInfo,
                        industry,
                        subCategory,
                        results,
                    };
                    const jsonString = JSON.stringify(dataToSave, null, 2);
                    const blob = new Blob([jsonString], { type: "application/json" });
                    const url = URL.createObjectURL(blob);
                    const link = document.createElement('a');
                    link.href = url;
                    link.download = `risikoanalyse-${clientInfo.name.replace(/\s+/g, '_')}.json`;
                    document.body.appendChild(link);
                    link.click();
                    document.body.removeChild(link);
                    URL.revokeObjectURL(url);
                };

                const handleGeneratePeerGroup = async () => {
                    setIsPeerGroupLoading(true);
                    setPeerGroup(null);
                    setPeerGroupError(null);

                     const prompt = `WICHTIG: Antworte NUR mit validem JSON. Keine Erklärungen oder zusätzlichen Texte.
                        FORMAT: [{"name": "Firmenname", "nationality": "DE", "business_focus": "ERP-Software", "website_url": "https://www.beispiel.de", "ev_ebitda_ltm": "15.2x", "ev_ebitda_current": "14.1x", "ev_sales": "3.5x", "pe_ratio": "35.0", "ebitda_margin": "25.5%"}]
                        AUFGABE: Erstelle ein JSON-Array mit bis zu 10 börsennotierten Unternehmen für: '${industryName} - ${subCategoryData.name}'.
                        REGELN:
                        - Antworte AUSSCHLIESSLICH mit dem JSON-Array.
                        - "nationality" muss ein zweistelliger ISO-Ländercode sein (z.B. "US", "DE").
                        - "business_focus" sollte 2-3 Wörter lang sein.
                        - "website_url" muss eine gültige URL sein.
                        - Alle Kennzahlen als String formatieren. Für Multiples 'x' anhängen, für Margen '%'.
                        - Bei fehlenden Daten "N/A" verwenden.
                        BEGINNE DEINE ANTWORT DIREKT MIT: [`;

                    try {
                        const response = await callGeminiAPI(prompt, true);
                        if(Array.isArray(response)) {
                            setPeerGroup(response);
                        } else {
                            throw new Error("Die erstellte Antwort ist kein Array, wie erwartet.");
                        }
                    } catch (e) {
                        console.error("Fehler beim Verarbeiten der Peergroup-Antwort: ", e);
                        setPeerGroupError(e.message || "Ein unbekannter Fehler ist aufgetreten.");
                    } finally {
                        setIsPeerGroupLoading(false);
                    }
                };

                const handleGenerateMarketDevelopment = async () => {
                    setIsMarketDevLoading(true);
                    setMarketDevelopment(null);
                    setMarketDevError(null);
                
                    const currentYear = new Date().getFullYear();
                    const years = [currentYear - 2, currentYear - 1, currentYear];
                
                    const prompt = `WICHTIG: Antworte NUR mit einem validen JSON-Objekt. Keine Erklärungen oder einleitenden Texte.
                    
                    AUFGABE: Erstelle eine detaillierte Marktanalyse für die Branche "${industryName} - ${subCategoryData.name}".
                    
                    STRUKTUR DER ANTWORT (JSON):
                    {
                      "title": "Ein String, z.B. '${industryName}'.",
                      "multiples_entwicklung": [
                        {"year": "${years[0]}", "multiple": "String mit realistischem EV/EBITDA Multiple für das Jahr, z.B. '10.5x'"},
                        {"year": "${years[1]}", "multiple": "String, z.B. '11.2x'"},
                        {"year": "${currentYear} (F)", "multiple": "String mit Forecast, z.B. '11.8x'"}
                      ],
                      "marktueberblick": "Ein String (ca. 100-120 Wörter), der Marktgröße, Wachstumsrate (CAGR), Marktreife und geografische Verteilung abdeckt.",
                      "schluesseltrends": "Ein String (ca. 120-140 Wörter) mit den wichtigsten Treibern. Nutze '*' für Aufzählungspunkte, z.B. '* Technologietrend 1: ...\\n* Technologietrend 2: ...'.",
                      "wettbewerbslandschaft": "Ein String (ca. 100-120 Wörter), der Marktkonzentration, Wettbewerbsdynamik, Eintrittsbarrieren und M&A-Aktivitäten beschreibt.",
                      "top_10_players": [
                        {"name": "Name des Top-Players 1", "market_share": "String, z.B. '25%'"},
                        {"name": "Name des Top-Players 2", "market_share": "String, z.B. '15%'},
                        {"name": "Name des Top-Players 3", "market_share": "String, z.B. '10%'"},
                        {"name": "Name des Top-Players 4", "market_share": "String, z.B. '8%'"},
                        {"name": "Name des Top-Players 5", "market_share": "String, z.B. '6%'"},
                        {"name": "Name des Top-Players 6", "market_share": "String, z.B. '5%'"},
                        {"name": "Name des Top-Players 7", "market_share": "String, z.B. '4%'"},
                        {"name": "Name des Top-Players 8", "market_share": "String, z.B. '3%'"},
                        {"name": "Name des Top-Players 9", "market_share": "String, z.B. '2%'"},
                        {"name": "Name des Top-Players 10", "market_share": "String, z.B. '1%'"}
                      ],
                      "chancen": "Ein String (ca. 80-100 Wörter) mit den größten Wachstumschancen. Nutze '*' für Aufzählungspunkte.",
                      "risiken": "Ein String (ca. 80-100 Wörter) mit den Hauptrisiken. Nutze '*' für Aufzählungspunkte.",
                      "ausblick_empfehlungen": "Ein String (ca. 80-100 Wörter) mit einer kurz- und mittelfristigen Prognose sowie strategischen Empfehlungen."
                    }
                    
                    REGELN:
                    - Alle Werte im JSON müssen Strings sein.
                    - Ersetze die Beispielinhalte mit fundierten, professionellen Texten, die auf die Branche zugeschnitten sind.
                    - Beginne deine Antwort DIREKT mit der öffnenden geschweiften Klammer {
                    `;
                
                    try {
                        const response = await callGeminiAPI(prompt, true);
                        if(response && response.multiples_entwicklung) {
                            setMarketDevelopment(response);
                        } else {
                            throw new Error("Die erstellte Antwort hat nicht das erwartete JSON-Format.");
                        }
                    } catch (e) {
                        console.error("Fehler bei der Analyse der Marktentwicklung: ", e);
                        setMarketDevError(e.message || "Ein unbekannter Fehler ist aufgetreten.");
                    } finally {
                        setIsMarketDevLoading(false);
                    }
                };
                
                return (
                    <div className="w-full max-w-6xl mx-auto">
                        
                        <div className="text-center mb-10">
                            <h2 className="text-3xl font-bold text-gray-800">Ergebnis der Risikoanalyse: {industryName}</h2>
                            <p className="mt-2 text-lg text-gray-600">Für Projekt: {clientInfo.name}</p>
                             <div className="flex flex-wrap justify-center items-center gap-4 mt-6">
                                 <button onClick={handleGenerateReportContent} className="inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-emerald-600 hover:bg-emerald-700 disabled:bg-gray-400" disabled={isActionPlanLoading}><FileText className="w-5 h-5 mr-2" /> Bericht & Maßnahmen</button>
                                 <button onClick={handleGeneratePeerGroup} disabled={isPeerGroupLoading} className="inline-flex items-center justify-center px-4 py-2 border border-sky-600 text-sm font-medium rounded-md shadow-sm text-sky-700 bg-white hover:bg-sky-50 disabled:bg-gray-200 disabled:cursor-not-allowed"><Users className="w-5 h-5 mr-2" /> Peergroup</button>
                                 <button onClick={handleGenerateMarketDevelopment} disabled={isMarketDevLoading} className="inline-flex items-center justify-center px-4 py-2 border border-indigo-600 text-sm font-medium rounded-md shadow-sm text-indigo-700 bg-white hover:bg-indigo-50 disabled:bg-gray-200 disabled:cursor-not-allowed"><TrendingUp className="w-5 h-5 mr-2" /> Marktentwicklung</button>
                                 <button onClick={handleSave} className="inline-flex items-center justify-center px-4 py-2 border border-gray-600 text-sm font-medium rounded-md shadow-sm text-gray-700 bg-white hover:bg-gray-50"><Download className="w-5 h-5 mr-2" /> Speichern</button>
                             </div>
                        </div>
    
                        <div className="space-y-8 mb-12">
                            <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                                <div className="space-y-8 flex flex-col">
                                    <div className="bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col justify-center items-center text-center">
                                        <h3 className="text-lg font-semibold text-gray-500">Gesamtergebnis</h3>
                                        <div className="flex items-center my-2">
                                            <TrendingDown className={`w-16 h-16 mr-4 ${getRiskColor(totalDiscount)}`}/>
                                            <p className={`text-6xl font-bold ${getRiskColor(totalDiscount)}`}>-{(totalDiscount * 100).toFixed(1)}%</p>
                                        </div>
                                        <p className="text-gray-700 font-semibold text-lg">Abschlag vom Multiple</p>
                                    </div>
                                    <Bewertungsrechner 
                                        industry={industry} 
                                        subCategory={subCategory} 
                                        totalDiscount={totalDiscount} 
                                        getRiskColor={getRiskColor} 
                                        calculatorState={calculatorState} 
                                        onCalculatorChange={setCalculatorState}
                                        standardMultiples={standardMultiples}
                                    />
                                </div>
                                <div className="bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col">
                                   <h3 className="text-lg font-semibold text-gray-800 mb-4 flex items-center shrink-0"><Radar className="w-5 h-5 mr-2 text-gray-600" />Risikoprofil im Branchenvergleich</h3>
                                   <div className="relative flex-grow min-h-[24rem]">
                                    <RadarChart userScores={userScores} benchmarkScores={benchmarkData} />
                                   </div>
                                </div>
                            </div>
    
                            <DiscountDerivationTable results={results} getRiskColor={getRiskColor} onWeightingChange={handleWeightingChange} />
                            
                            <PeerGroupTable peerGroup={peerGroup} isLoading={isPeerGroupLoading} error={peerGroupError} />
                            
                            <MarketDevelopment data={marketDevelopment} isLoading={isMarketDevLoading} error={marketDevError} />
                            
                            <ActionPlansSection actionPlans={actionPlans} isLoading={isActionPlanLoading} error={actionPlanError} />

                        </div>
    
    
                        <h3 className="text-2xl font-bold text-gray-800 text-center mb-6">Handlungsfelder im Detail</h3>
                         <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                             {detailedBreakdown.sort((a,b) => b.discount - a.discount).map((item) => (
                                 <div key={item.category} className="bg-white p-6 rounded-xl shadow-lg border border-gray-100 flex flex-col">
                                     <div className="flex items-center mb-1">{categoryIcons[item.category]}<h4 className="text-xl font-bold text-gray-800">{item.label}</h4></div>
                                     <p className="text-xs text-gray-500 mb-2 ml-9">({questionsPerCategory[item.category] || 0} von {questions.length} Fragen)</p>
                                      <div className="flex-grow mb-4">
                                           <BenchmarkChart userValue={item.riskPercentage * 100} benchmarkValue={benchmarkData ? benchmarkData[item.category] * 100 : null} />
                                       </div>
                                     {item.riskPercentage > (benchmarkData[item.category] || 0) ? (
                                        <div className="mt-auto text-sm text-center text-orange-700 bg-orange-50 p-3 rounded-md flex items-center justify-center">
                                            <TrendingDown className="w-5 h-5 mr-2" />
                                            Handlungsbedarf identifiziert.
                                        </div>
                                     ) : (
                                         <div className="mt-auto text-sm text-center text-green-700 bg-green-50 p-3 rounded-md flex items-center justify-center">
                                             <CheckCircle className="w-5 h-5 mr-2" />
                                             Besser als Branchenschnitt.
                                         </div>
                                     )}
                                 </div>
                             ))}
                         </div>
                         

                         <div className="mt-12 bg-white p-6 rounded-xl shadow-lg border border-gray-100">
                            <h3 className="text-2xl font-bold text-gray-800 text-center mb-6">Fragen & Antworten</h3>
                            <table className="w-full text-left">
                                <thead>
                                    <tr className="border-b-2 border-gray-200">
                                        <th className="p-3 text-sm font-semibold uppercase text-gray-500">Frage</th>
                                        <th className="p-3 text-sm font-semibold uppercase text-gray-500">Ihre Antwort</th>
                                        <th className="p-3 text-sm font-semibold uppercase text-gray-500 text-center">Risikowert</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    {Object.entries(groupedQuestions).map(([category, qs]) => (
                                        <React.Fragment key={category}>
                                            <tr className="bg-gray-50">
                                                <th colSpan="3" className="p-3 text-base font-semibold text-gray-800">
                                                    {riskMatrix[category].label}
                                                </th>
                                            </tr>
                                            {qs.map(q => {
                                                const answerValue = answers[q.id];
                                                const selectedOption = q.options.find(opt => opt.value === answerValue);
                                                const riskColorClass = answerValue <= 2 ? "bg-green-100 text-green-800" : answerValue <= 3 ? "bg-yellow-100 text-yellow-800" : "bg-red-100 text-red-800";
                                                
                                                return (
                                                    <tr key={q.id} className="border-b border-gray-100 last:border-b-0">
                                                        <td className="p-3 text-sm text-gray-700">{q.text}</td>
                                                        <td className="p-3 text-sm text-gray-600">{selectedOption ? selectedOption.text : 'N/A'}</td>
                                                        <td className="p-3 text-center">
                                                            <span className={`px-3 py-1 text-xs font-bold rounded-full ${riskColorClass}`}>
                                                                {answerValue}
                                                            </span>
                                                        </td>
                                                    </tr>
                                                );
                                            })}
                                        </React.Fragment>
                                    ))}
                                </tbody>
                            </table>
                         </div>
    
                        <ContactPerson />
    
                        <div className="text-center mt-12"><button onClick={onRestart} className="bg-gray-700 text-white font-bold py-3 px-6 rounded-lg hover:bg-gray-800 transition-all duration-300 ease-in-out flex items-center justify-center mx-auto shadow-lg"><RotateCcw className="mr-2 w-5 h-5" /> Neue Analyse starten</button></div>
                    </div>
                );
            }
            
            return (
                <div className="bg-gray-50 min-h-screen font-sans text-gray-900 flex flex-col">
                    <header className="bg-white shadow-md z-10">
                        <div className="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3">
                            <div className="flex flex-wrap justify-between items-center gap-y-3">
                                <div className="flex items-center">
                                    <ShieldCheck className="h-10 w-10 text-emerald-600" />
                                    <div className="ml-3">
                                        <p className="text-xl font-bold text-gray-800">WALTERFRIES</p>
                                        <p className="text-xs text-gray-500 tracking-wider">GRUPPE | UNTERNEHMENSBEWERTUNG</p>
                                    </div>
                                </div>
                                <p className="text-sm font-semibold text-gray-600 hidden md:block">Projekt-Cockpit: Risikoanalyse</p>
                            </div>
                        </div>
                    </header>
                    <main className="flex-grow flex items-center justify-center p-4 sm:p-6 lg:p-8">
                        {isUnlocked || countdownEnded ? (
                            renderMainApp()
                        ) : (
                            <div className="text-center">
                                <h2 className="text-2xl font-bold text-gray-800">Das Analyse-Tool wird bald freigeschaltet</h2>
                                <p className="mt-2 text-lg text-gray-600">Verbleibende Zeit:</p>
                                <Countdown onCountdownEnd={() => setCountdownEnded(true)} />
                                <div className="mt-8">
                                    <PasswordScreen onUnlock={() => setIsUnlocked(true)} />
                                </div>
                            </div>
                        )}
                    </main>
                    <footer className="bg-white mt-auto py-4">
                        <div className="text-center text-xs text-gray-500">
                            <p>&copy; {new Date().getFullYear()} WALTERFRIES Gruppe. Alle Rechte vorbehalten.</p>
                            <p className="mt-1">Dieses Tool dient als Prototyp. Die Ergebnisse und Benchmark-Daten sind illustrativ und stellen keine verbindliche Analyse dar.</p>
                        </div>
                    </footer>
                </div>
            );
        }

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>
